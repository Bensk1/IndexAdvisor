with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ivory','chiffon','sky','blue','almond','antique') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','orange','azure','burlywood','cornsilk','black') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','indian','lime','olive','peach','turquoise') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','peach','lime','antique','steel','aquamarine') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','red','plum','firebrick','chartreuse','cyan') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','peach','papaya','orchid','ivory','lime') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','cornflower','floral','slate','black','firebrick') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','dark','powder','pale','snow','sienna') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','frosted','lavender','tomato','khaki','coral') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','medium','firebrick','lawn','pale','saddle') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','chocolate','rosy','deep','yellow','brown') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','bisque','light','ghost','frosted','orchid') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','cream','violet','antique','navajo','floral') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','orange','deep','blanched','ivory','azure') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','blue','pink','powder','lace','lemon') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','deep','sky','puff','blue','aquamarine') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','violet','gainsboro','blue','seashell','burlywood') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','firebrick','magenta','red','papaya','orchid') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','ghost','peach','gainsboro','rosy','antique') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','frosted','moccasin','lavender','metallic','bisque') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','rosy','puff','lime','tan','green') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','plum','ghost','snow','lawn','deep') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','beige','maroon','wheat','peru','saddle') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dim','steel','drab','turquoise','puff','lime') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','wheat','tomato','midnight','peach','lemon') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','cornflower','red','antique','burlywood','frosted') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','medium','cyan','sky','brown','goldenrod') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','green','steel','ivory','purple','drab') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','magenta','cornflower','antique','blanched','pink') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','pink','navy','lemon','forest','olive') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','tomato','burnished','linen','light','olive') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','steel','dodger','dark','orchid','antique') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','burlywood','lemon','cornsilk','salmon','navajo') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','bisque','burnished','lavender','peru','magenta') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','pink','dodger','chiffon','metallic','royal') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','saddle','slate','floral','moccasin','purple') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','peru','aquamarine','lemon','sky','deep') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','pink','tomato','cyan','lavender','lawn') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','beige','light','firebrick','wheat','plum') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chiffon','olive','linen','midnight','blush','snow') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('aquamarine','mint','magenta','rose','pale','ivory') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dim','blush','maroon','plum','thistle','salmon') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','thistle','firebrick','midnight','purple','almond') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','spring','forest','chiffon','chocolate','medium') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','khaki','gainsboro','smoke','misty','magenta') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','salmon','violet','aquamarine','floral','chocolate') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lace','plum','white','pale','powder','lavender') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','beige','moccasin','aquamarine','papaya','burlywood') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','ghost','plum','rose','misty','indian') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','smoke','metallic','olive','peach','ivory') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','sky','papaya','linen','coral','purple') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','honeydew','salmon','sky','blue','pale') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','steel','wheat','almond','navajo','metallic') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','mint','sienna','grey','purple','orange') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','puff','ghost','lavender','steel','dodger') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','peach','snow','navy','spring','dodger') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('bisque','maroon','burnished','dodger','snow','powder') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','saddle','gainsboro','yellow','metallic','navy') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','lemon','lace','pink','ivory','orchid') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','orchid','chiffon','linen','wheat','spring') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('maroon','dark','forest','light','sandy','seashell') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','puff','chartreuse','orchid','tomato','purple') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','lace','chartreuse','saddle','sky','salmon') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','red','pink','orange','drab','spring') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','bisque','tan','cream','salmon','sky') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','blanched','peach','turquoise','lime','firebrick') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','ghost','olive','seashell','cornsilk','orange') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chiffon','saddle','violet','peach','sky','brown') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','medium','gainsboro','khaki','linen','pale') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','almond','grey','orange','lawn','floral') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','orchid','honeydew','dim','indian','puff') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','hot','sky','black','linen','saddle') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','peach','black','salmon','sandy','khaki') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','cornsilk','blush','rose','blanched','almond') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('plum','magenta','tomato','white','salmon','rose') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','olive','midnight','tan','sandy','slate') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','goldenrod','steel','smoke','burlywood','rosy') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','olive','chiffon','powder','steel','metallic') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','dark','moccasin','pale','hot','indian') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','mint','antique','sandy','goldenrod','dim') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','metallic','pale','burnished','cornflower','khaki') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','brown','cornsilk','rose','pale','dim') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','saddle','floral','orchid','papaya','honeydew') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','puff','lemon','aquamarine','antique','khaki') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','white','goldenrod','royal','lemon','linen') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','rosy','red','black','deep','navy') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','tan','indian','orange','blanched','spring') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','linen','antique','chiffon','dark','pale') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','violet','sienna','deep','papaya','frosted') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','thistle','salmon','aquamarine','chartreuse','bisque') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','sky','goldenrod','seashell','pale','firebrick') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','firebrick','lime','pink','chiffon','burlywood') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','ivory','chiffon','smoke','goldenrod','burnished') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','blue','pink','rose','aquamarine','grey') and          i_current_price between 85 and 85 + 10 and          i_current_price between 85 + 1 and 85 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','olive','cornsilk','plum','almond','midnight') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','rosy','blanched','metallic','red','azure') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','cyan','mint','powder','rose','almond') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','midnight','brown','coral','red','azure') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','hot','coral','navy','aquamarine','navajo') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','blanched','lavender','burlywood','sienna','sky') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','gainsboro','bisque','pale','puff','misty') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','pale','chiffon','yellow','mint','chocolate') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','chocolate','metallic','rosy','dim','deep') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','light','beige','dim','brown','olive') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','slate','papaya','deep','sky','cornflower') and          i_current_price between 13 and 13 + 10 and          i_current_price between 13 + 1 and 13 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','plum','sienna','sandy','olive','papaya') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','azure','seashell','sienna','black','steel') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','orchid','yellow','lawn','frosted','tan') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','spring','midnight','mint','coral','burlywood') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','chocolate','orange','cornflower','lime','slate') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','sienna','maroon','cornflower','chartreuse','hot') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','ghost','chocolate','white','coral','mint') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','turquoise','beige','linen','antique','navy') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','metallic','cyan','tomato','frosted','ghost') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','deep','midnight','burnished','sky','peru') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','smoke','blush','aquamarine','navy','bisque') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','dim','chocolate','firebrick','ghost','royal') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('bisque','misty','lemon','spring','burlywood','plum') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','steel','grey','frosted','lavender','olive') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','goldenrod','plum','burnished','puff','green') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','light','dim','plum','tomato','navy') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('maroon','gainsboro','dark','chocolate','pale','violet') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','chartreuse','orchid','azure','bisque','ivory') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','royal','rosy','indian','cyan','frosted') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','grey','brown','violet','cornflower','pale') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','salmon','firebrick','aquamarine','papaya','thistle') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lace','lavender','brown','honeydew','purple','thistle') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','midnight','firebrick','cornsilk','burnished','antique') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','seashell','peach','beige','khaki','puff') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','sky','deep','blanched','spring','antique') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','puff','navajo','orchid','powder','rose') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','burnished','light','burlywood','floral','misty') and          i_current_price between 85 and 85 + 10 and          i_current_price between 85 + 1 and 85 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','peru','white','almond','lemon','powder') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','misty','hot','frosted','orchid','maroon') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','smoke','maroon','navy','indian','orchid') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','black','indian','brown','almond','dim') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','thistle','sandy','navy','coral','steel') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','purple','steel','lemon','misty','lawn') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','royal','papaya','almond','gainsboro','burlywood') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','royal','smoke','slate','dodger','burnished') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ivory','olive','linen','tomato','dim','firebrick') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chiffon','dodger','royal','grey','powder','olive') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','firebrick','brown','lemon','plum','chartreuse') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tan','royal','orange','purple','chartreuse','indian') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','orchid','blue','burlywood','dodger','chartreuse') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','turquoise','lavender','orchid','blanched','coral') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','navy','goldenrod','antique','snow','blanched') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','sky','red','goldenrod','orange','magenta') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','lawn','almond','pink','wheat','antique') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','frosted','navy','antique','light','indian') and          i_current_price between 13 and 13 + 10 and          i_current_price between 13 + 1 and 13 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','orchid','blue','misty','antique','peach') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','turquoise','navajo','moccasin','cyan','khaki') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','pale','navajo','metallic','bisque','black') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','navajo','bisque','chartreuse','lime','mint') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','tomato','purple','firebrick','beige','sky') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','moccasin','puff','floral','cornsilk','green') and          i_current_price between 73 and 73 + 10 and          i_current_price between 73 + 1 and 73 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('bisque','cornsilk','powder','goldenrod','chiffon','tomato') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','orchid','firebrick','grey','black','chiffon') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','spring','sky','violet','green','tomato') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('antique','linen','beige','grey','midnight','aquamarine') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','coral','mint','deep','smoke','light') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','dodger','sienna','maroon','smoke','steel') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','coral','thistle','ivory','almond','violet') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','sky','black','green','wheat','lawn') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','pink','cornflower','green','moccasin','grey') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','cornflower','purple','plum','royal','beige') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','snow','wheat','slate','thistle','green') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','dark','drab','slate','almond','snow') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','hot','midnight','navajo','spring','floral') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','moccasin','powder','antique','almond','peru') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','antique','pink','tomato','sky','burnished') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','slate','wheat','medium','light','beige') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','cream','brown','goldenrod','gainsboro','ivory') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','dodger','metallic','lavender','deep','lime') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','misty','snow','light','pale','maroon') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','sky','cornflower','linen','tan','azure') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','mint','smoke','frosted','ivory','wheat') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','khaki','lime','yellow','chocolate','maroon') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','salmon','sandy','rosy','deep','metallic') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pale','powder','frosted','green','plum','seashell') and          i_current_price between 48 and 48 + 10 and          i_current_price between 48 + 1 and 48 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','salmon','magenta','peach','royal','frosted') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','cornflower','burnished','green','salmon','plum') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','sienna','cyan','indian','puff','ghost') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','metallic','lavender','wheat','steel','powder') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','metallic','rose','lime','lemon','blush') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','deep','rosy','thistle','burnished','blush') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','snow','almond','dodger','burlywood','khaki') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','wheat','deep','orange','snow','sienna') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('maroon','magenta','grey','burnished','brown','royal') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','beige','blue','peach','linen','firebrick') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','tan','firebrick','salmon','deep','purple') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','antique','snow','medium','cornsilk','ghost') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','light','tomato','chocolate','antique','lace') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','blanched','cornsilk','spring','misty','mint') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pale','violet','powder','spring','smoke','ghost') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','bisque','floral','lavender','indian','peach') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orchid','navajo','brown','puff','dodger','purple') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','bisque','peach','beige','chocolate','seashell') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','rose','orchid','pink','misty','indian') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','navajo','lawn','lemon','honeydew','spring') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','bisque','midnight','olive','chartreuse','black') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','saddle','olive','puff','navy','turquoise') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','khaki','smoke','red','cornsilk','grey') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','purple','goldenrod','plum','dark','turquoise') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','yellow','goldenrod','dim','plum','royal') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','lawn','royal','cyan','tomato','blue') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','slate','linen','blush','turquoise','pale') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','magenta','ghost','azure','maroon','olive') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','peru','hot','lace','black','puff') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','orange','metallic','goldenrod','dodger','magenta') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','honeydew','rosy','mint','antique','lavender') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('plum','indian','papaya','navy','ghost','rosy') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','yellow','chocolate','burnished','snow','azure') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('plum','chiffon','indian','salmon','azure','blue') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','rose','burlywood','frosted','lawn','grey') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','seashell','ivory','chartreuse','sandy','metallic') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','orange','rosy','blue','purple','tomato') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','lavender','linen','gainsboro','peru','navajo') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','black','aquamarine','midnight','blush','burlywood') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','seashell','navy','yellow','slate','burlywood') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','cyan','floral','rosy','navajo','forest') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','firebrick','medium','blanched','ivory','dark') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','pale','green','orange','goldenrod','smoke') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','black','wheat','drab','indian','frosted') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','indian','puff','lace','lime','tan') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','sky','white','navajo','powder','bisque') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','rose','smoke','maroon','cornsilk','rosy') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','salmon','firebrick','frosted','antique','light') and          i_current_price between 8 and 8 + 10 and          i_current_price between 8 + 1 and 8 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','cornflower','lavender','ivory','mint','chocolate') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','cyan','powder','red','chiffon','moccasin') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','almond','antique','saddle','blue','linen') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','snow','frosted','smoke','lime','grey') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','frosted','yellow','goldenrod','moccasin','thistle') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('maroon','beige','misty','spring','pink','lavender') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','steel','yellow','white','cream','drab') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','bisque','papaya','moccasin','wheat','firebrick') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','light','violet','frosted','black','burnished') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','cornflower','ghost','smoke','deep','wheat') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pale','magenta','olive','powder','yellow','moccasin') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','metallic','lime','navajo','salmon','firebrick') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','magenta','linen','lime','orchid','chartreuse') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','lemon','medium','almond','purple','drab') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','violet','khaki','wheat','dodger','lime') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','lemon','peru','thistle','pale','ivory') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','linen','maroon','peach','indian','snow') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','frosted','rose','azure','goldenrod','seashell') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','pink','red','chartreuse','honeydew','forest') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','indian','mint','powder','light','brown') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','lavender','chartreuse','pink','pale','red') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','ivory','steel','cyan','turquoise','linen') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lace','seashell','burnished','medium','bisque','dodger') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','olive','metallic','floral','bisque','cyan') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','navajo','ivory','olive','antique','rosy') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','brown','lime','plum','antique','steel') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','brown','lavender','steel','lemon','medium') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','goldenrod','seashell','chocolate','turquoise','tan') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','lime','sienna','deep','lawn','dodger') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','ghost','rose','hot','peach','forest') and          i_current_price between 48 and 48 + 10 and          i_current_price between 48 + 1 and 48 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','dodger','green','snow','khaki','goldenrod') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','red','plum','almond','dim','forest') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','gainsboro','royal','brown','salmon','pale') and          i_current_price between 55 and 55 + 10 and          i_current_price between 55 + 1 and 55 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','chiffon','lace','sienna','papaya','honeydew') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','frosted','rose','tomato','hot','burnished') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('aquamarine','puff','chocolate','spring','rosy','blue') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','cream','peru','blue','blanched','smoke') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','pale','wheat','misty','maroon','orange') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','floral','midnight','firebrick','salmon','powder') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','rosy','honeydew','salmon','midnight','aquamarine') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('moccasin','navajo','light','cyan','royal','peach') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','gainsboro','wheat','moccasin','goldenrod','azure') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','royal','slate','lavender','hot','frosted') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('moccasin','cornflower','red','powder','violet','yellow') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','spring','tomato','turquoise','burnished','snow') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','gainsboro','orchid','antique','lace','medium') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','floral','olive','violet','turquoise','plum') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','cyan','smoke','ghost','maroon','tomato') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','thistle','maroon','dim','peach','beige') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','tan','spring','blanched','plum','olive') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','rose','brown','light','cornsilk','seashell') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','bisque','chocolate','red','orange','metallic') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','linen','steel','ivory','blush','chiffon') and          i_current_price between 13 and 13 + 10 and          i_current_price between 13 + 1 and 13 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','chocolate','pink','dodger','tomato','lace') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','smoke','violet','chartreuse','hot','yellow') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','floral','slate','chartreuse','wheat','navajo') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','aquamarine','chiffon','olive','blanched','floral') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','coral','misty','beige','lawn','linen') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','moccasin','saddle','deep','spring','puff') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','lavender','wheat','medium','slate','indian') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','tomato','antique','linen','slate','misty') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','brown','coral','green','khaki','puff') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orchid','pale','lawn','royal','powder','smoke') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','forest','deep','tan','dark','burlywood') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','lime','rosy','gainsboro','dim','seashell') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','cornsilk','frosted','cyan','lawn','snow') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','linen','deep','light','chartreuse','royal') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','peru','pink','hot','maroon','blanched') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','brown','misty','blue','forest','blush') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('plum','pale','spring','turquoise','sienna','thistle') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('indian','midnight','puff','almond','tomato','aquamarine') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cyan','almond','violet','dim','thistle','navy') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','yellow','linen','cornsilk','burnished','chartreuse') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','chiffon','ivory','lemon','blush','snow') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','pink','lavender','deep','misty','floral') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','light','grey','green','sandy','dim') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','lemon','burlywood','orange','burnished','bisque') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','violet','mint','dark','gainsboro','tan') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','rose','white','firebrick','magenta','peach') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cyan','lime','hot','sky','seashell','peach') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','sky','white','smoke','lawn','dim') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','cyan','grey','drab','lace','ivory') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','snow','royal','purple','hot','light') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','papaya','bisque','violet','magenta','purple') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','drab','cornsilk','green','orange','lawn') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','lace','chocolate','antique','thistle','burnished') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','almond','cornsilk','burlywood','goldenrod','smoke') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dim','seashell','light','deep','lime','azure') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','cornflower','seashell','lemon','wheat','green') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','orange','sky','violet','blue','tomato') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','wheat','magenta','moccasin','indian','thistle') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','honeydew','turquoise','plum','firebrick','blush') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','slate','chartreuse','mint','brown','cyan') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','violet','floral','pale','khaki','orchid') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','snow','purple','wheat','hot','burnished') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','green','turquoise','grey','slate','misty') and          i_current_price between 55 and 55 + 10 and          i_current_price between 55 + 1 and 55 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','azure','rosy','almond','cornflower','antique') and          i_current_price between 85 and 85 + 10 and          i_current_price between 85 + 1 and 85 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','lime','steel','medium','spring','dim') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','coral','beige','khaki','pink','cornflower') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pale','brown','tan','antique','mint','navy') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','beige','spring','moccasin','bisque','dark') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','blush','navy','aquamarine','light','white') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','khaki','lawn','midnight','indian','deep') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','sandy','midnight','steel','light','violet') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','violet','hot','orchid','pink','black') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','medium','lime','black','forest','beige') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','cornflower','magenta','drab','beige','tomato') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','orange','linen','gainsboro','cream','misty') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chiffon','drab','metallic','papaya','dark','hot') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','turquoise','gainsboro','burlywood','tan','moccasin') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','green','moccasin','puff','cyan','black') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','yellow','royal','cornsilk','dark','gainsboro') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','violet','aquamarine','cream','pink','wheat') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','orchid','cornsilk','lavender','dim','bisque') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','white','dim','lace','beige','purple') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','antique','plum','gainsboro','almond','azure') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cyan','tomato','thistle','steel','magenta','moccasin') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','chocolate','sky','salmon','khaki','rose') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','white','orchid','misty','seashell','khaki') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','dodger','grey','dark','spring','yellow') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','red','ivory','midnight','wheat','chocolate') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','navajo','magenta','lime','almond','grey') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','chocolate','aquamarine','brown','chartreuse','linen') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','wheat','medium','blanched','seashell','aquamarine') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','deep','ghost','saddle','tan','cream') and          i_current_price between 73 and 73 + 10 and          i_current_price between 73 + 1 and 73 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','sienna','snow','lemon','dodger','magenta') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','salmon','azure','medium','beige','wheat') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','orange','magenta','chocolate','misty','white') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','sienna','grey','turquoise','indian','seashell') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','white','ivory','lace','burlywood','medium') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('plum','chocolate','blanched','pink','steel','lawn') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','burlywood','blanched','gainsboro','turquoise','white') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','cornflower','tan','chartreuse','almond','royal') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','misty','gainsboro','drab','peru','olive') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','bisque','almond','lavender','forest','slate') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','blanched','floral','almond','misty','spring') and          i_current_price between 13 and 13 + 10 and          i_current_price between 13 + 1 and 13 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','cornsilk','peru','black','plum','aquamarine') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','cyan','floral','blush','lawn','purple') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','tan','navajo','sandy','spring','yellow') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','olive','khaki','medium','seashell','pink') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ivory','moccasin','lemon','coral','blanched','lawn') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','cream','linen','ghost','chocolate','slate') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','goldenrod','beige','olive','burnished','rosy') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','brown','light','coral','salmon','slate') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','orchid','orange','lime','salmon','thistle') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','dodger','metallic','orange','coral','lime') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','lace','cream','puff','yellow','sienna') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','misty','puff','antique','frosted','peru') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','coral','cyan','tomato','midnight','ivory') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','peru','indian','cornsilk','sky','peach') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','sky','medium','steel','midnight','antique') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','gainsboro','khaki','sandy','rose','blue') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','khaki','burlywood','magenta','blanched','chocolate') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','metallic','cornsilk','cornflower','lawn','goldenrod') and          i_current_price between 8 and 8 + 10 and          i_current_price between 8 + 1 and 8 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','misty','seashell','blush','blue','yellow') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','azure','olive','red','papaya','salmon') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','black','dark','rose','blush','firebrick') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','forest','peru','dim','salmon','midnight') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','light','misty','black','olive','yellow') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','grey','dodger','rose','lemon','peru') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','lavender','burnished','rosy','blush','puff') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','yellow','misty','chocolate','midnight','antique') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','lemon','deep','firebrick','tomato','steel') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','sky','lime','azure','honeydew','puff') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','papaya','burnished','steel','red','ghost') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','seashell','linen','floral','honeydew','sky') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','powder','cream','moccasin','ghost','sky') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','beige','slate','sienna','lavender','smoke') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','cornflower','khaki','lemon','powder','green') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','cornsilk','orchid','spring','steel','lavender') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','black','maroon','wheat','brown','olive') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','lavender','blush','dim','red','rosy') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','frosted','cornflower','blue','antique','coral') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','orange','chiffon','azure','white','sandy') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','pale','orchid','burnished','navajo','peru') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','aquamarine','white','seashell','cornflower','cream') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','light','firebrick','almond','plum','tan') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','mint','firebrick','turquoise','azure','wheat') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','misty','smoke','red','blue','orchid') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','saddle','cyan','chocolate','dodger','royal') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','sienna','moccasin','slate','tomato','dim') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','brown','royal','indian','salmon','khaki') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','chartreuse','navy','khaki','pale','papaya') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','dark','papaya','coral','chocolate','almond') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('maroon','royal','cream','brown','spring','bisque') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','mint','sandy','orchid','cyan','cornsilk') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chiffon','white','honeydew','lawn','dim','red') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','red','navajo','yellow','honeydew','misty') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','orange','coral','lawn','magenta','burnished') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','almond','pink','honeydew','puff','yellow') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','beige','almond','grey','sienna','pink') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','magenta','moccasin','red','rosy','midnight') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','plum','dodger','saddle','burnished','steel') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('smoke','maroon','chartreuse','olive','lemon','plum') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('antique','olive','dim','pale','powder','sandy') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','bisque','metallic','blanched','puff','salmon') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','almond','navajo','sienna','thistle','lavender') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','pink','olive','plum','light','deep') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','orchid','indian','bisque','sienna','purple') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','puff','magenta','dim','tomato','blanched') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','lace','navajo','cyan','turquoise','dark') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','brown','honeydew','antique','indian','steel') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','sandy','sienna','metallic','blanched','frosted') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','chartreuse','burnished','spring','tomato','rosy') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','drab','saddle','slate','dark','magenta') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','mint','firebrick','gainsboro','hot','lime') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('smoke','salmon','chiffon','pink','rose','drab') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','mint','cyan','peach','frosted','forest') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','wheat','sandy','slate','chiffon','purple') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','lime','brown','antique','red','blush') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','orchid','lace','sandy','rose','metallic') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('indian','lace','rosy','light','red','goldenrod') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','lime','bisque','sandy','indian','gainsboro') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blue','lace','rose','navajo','saddle','linen') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','misty','cyan','khaki','navy','sandy') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','spring','magenta','coral','dim','almond') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','pale','lawn','smoke','dim','navajo') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','antique','blanched','burnished','ivory','peach') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','magenta','blanched','powder','moccasin','cyan') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','maroon','gainsboro','light','drab','cornsilk') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','puff','rosy','bisque','violet','royal') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','plum','forest','drab','lace','blanched') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','rose','lavender','violet','honeydew','cream') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','spring','tomato','orange','red','chiffon') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','coral','blanched','navy','floral','powder') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','slate','floral','burnished','lemon','lavender') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','white','forest','beige','bisque','green') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','beige','drab','cyan','midnight','khaki') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','magenta','midnight','indian','chocolate','grey') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','black','green','ghost','wheat','sandy') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','goldenrod','burnished','magenta','deep','floral') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','ghost','purple','midnight','metallic','honeydew') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','white','tan','salmon','yellow','almond') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','indian','violet','wheat','blush','blue') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','goldenrod','cyan','rosy','peach','almond') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','deep','bisque','violet','thistle','forest') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','pink','mint','blush','gainsboro','thistle') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','almond','beige','aquamarine','thistle','indian') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','dodger','forest','lemon','white','blue') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','white','powder','turquoise','ghost','cornflower') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','slate','papaya','blush','firebrick','lace') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('moccasin','peru','pale','indian','gainsboro','rosy') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','puff','firebrick','forest','peach','aquamarine') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','beige','floral','white','honeydew','cornsilk') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','khaki','floral','forest','drab','rosy') and          i_current_price between 55 and 55 + 10 and          i_current_price between 55 + 1 and 55 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','thistle','sky','firebrick','brown','orange') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','drab','lemon','thistle','firebrick','brown') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','lemon','navy','light','saddle','spring') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','linen','sky','steel','misty','honeydew') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','orchid','royal','honeydew','peach','turquoise') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','hot','floral','bisque','aquamarine','tan') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','snow','purple','thistle','azure','misty') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','violet','floral','dark','indian','antique') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','firebrick','beige','seashell','peru','lace') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','deep','rosy','grey','tomato','brown') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dim','saddle','black','dodger','forest','rose') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','salmon','moccasin','misty','spring','lime') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','moccasin','orange','aquamarine','navy','firebrick') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','khaki','burnished','moccasin','orange','rosy') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','tan','spring','misty','magenta','indian') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','papaya','chartreuse','indian','salmon','black') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','lavender','linen','burnished','pink','beige') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','goldenrod','yellow','puff','chiffon','misty') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('plum','firebrick','green','burnished','blush','azure') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','wheat','chiffon','turquoise','orange','chartreuse') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','indian','midnight','ivory','plum','tan') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','aquamarine','sandy','plum','azure','green') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','violet','linen','lace','royal','grey') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','dark','mint','beige','salmon','firebrick') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','magenta','bisque','navy','brown','lavender') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('bisque','pink','ghost','lemon','almond','azure') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','chartreuse','grey','rose','navy','cream') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','peru','azure','wheat','navy','linen') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','light','firebrick','orange','azure','saddle') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','cornflower','antique','thistle','indian','honeydew') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','coral','tan','saddle','navajo','pink') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','hot','floral','firebrick','chartreuse','ghost') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chiffon','rose','drab','green','maroon','pale') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','plum','violet','chiffon','beige','navy') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','beige','salmon','snow','light','ghost') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','cornsilk','misty','pink','brown','goldenrod') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('indian','navajo','steel','blanched','antique','black') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','sandy','mint','olive','orange','pale') and          i_current_price between 55 and 55 + 10 and          i_current_price between 55 + 1 and 55 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rosy','peach','moccasin','lace','hot','seashell') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','green','goldenrod','rose','cream','burlywood') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','forest','lawn','green','lemon','mint') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','sky','steel','papaya','wheat','red') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','gainsboro','lawn','cornflower','orchid','lime') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','honeydew','cream','lace','violet','navy') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','seashell','pale','frosted','dim','lemon') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','navajo','cornsilk','misty','dim','mint') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','seashell','peru','ghost','chartreuse','indian') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','cyan','antique','burlywood','papaya','smoke') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','tan','thistle','slate','ghost','lawn') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','bisque','sky','moccasin','violet','thistle') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','wheat','dodger','olive','navajo','azure') and          i_current_price between 85 and 85 + 10 and          i_current_price between 85 + 1 and 85 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','azure','misty','peach','peru','red') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','yellow','honeydew','floral','purple','deep') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','magenta','drab','lemon','powder','linen') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','tomato','olive','papaya','red','chocolate') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','white','black','ivory','frosted','smoke') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','frosted','plum','beige','hot','forest') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','coral','burlywood','bisque','light','peach') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','papaya','brown','firebrick','hot','drab') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','spring','sky','frosted','medium','royal') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','gainsboro','lavender','thistle','burlywood','snow') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','grey','snow','burlywood','navy','wheat') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','turquoise','green','floral','misty','royal') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','purple','violet','metallic','mint','bisque') and          i_current_price between 13 and 13 + 10 and          i_current_price between 13 + 1 and 13 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','blanched','antique','tomato','pink','orchid') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','purple','goldenrod','white','light','indian') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('indian','gainsboro','grey','seashell','cornflower','drab') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','chiffon','rosy','dodger','floral','gainsboro') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','blue','dim','cyan','salmon','lace') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','navy','puff','smoke','white','blush') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','drab','papaya','spring','ivory','dim') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','deep','aquamarine','plum','papaya','violet') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','rosy','misty','chiffon','cornsilk','slate') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','blanched','orange','slate','white','cyan') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','azure','salmon','magenta','firebrick','lime') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','deep','olive','sandy','sienna','burnished') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','puff','smoke','grey','linen','azure') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','brown','firebrick','grey','goldenrod','wheat') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','maroon','seashell','gainsboro','floral','blue') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','saddle','red','forest','papaya','blue') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','saddle','red','peru','puff','cyan') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','beige','pale','violet','burnished','steel') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','royal','frosted','khaki','blue','forest') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','chartreuse','burlywood','light','frosted','seashell') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','pale','forest','misty','medium','linen') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','coral','navy','navajo','midnight','spring') and          i_current_price between 73 and 73 + 10 and          i_current_price between 73 + 1 and 73 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','saddle','brown','moccasin','dim','metallic') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','wheat','ivory','plum','misty','bisque') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','yellow','peru','chiffon','tan','white') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','cornsilk','antique','rose','metallic','grey') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','moccasin','medium','salmon','azure','pale') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tan','deep','blue','tomato','light','seashell') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','rosy','navajo','chocolate','navy','spring') and          i_current_price between 13 and 13 + 10 and          i_current_price between 13 + 1 and 13 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','sienna','lace','misty','indian','grey') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','misty','rosy','lavender','plum','maroon') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','peach','cyan','indian','metallic','honeydew') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','ivory','white','honeydew','turquoise','violet') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','tomato','metallic','steel','chartreuse','hot') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','ghost','pale','salmon','hot','blush') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','yellow','chiffon','salmon','snow','orchid') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','coral','navajo','linen','powder','cyan') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','khaki','snow','yellow','slate','mint') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','chiffon','khaki','sky','ghost','magenta') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','royal','peru','honeydew','sandy','blue') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','blue','lace','chiffon','firebrick','sandy') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','blanched','antique','white','seashell','magenta') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','midnight','blanched','sandy','indian','lime') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','dodger','papaya','honeydew','purple','lawn') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','drab','wheat','gainsboro','navy','papaya') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','rose','pale','magenta','powder','seashell') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','turquoise','slate','blanched','white','medium') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','bisque','coral','magenta','chartreuse','maroon') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cyan','white','orange','maroon','beige','chiffon') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','blush','yellow','cream','ghost','beige') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','sandy','moccasin','slate','burlywood','lavender') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','beige','wheat','red','salmon','pale') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','indian','powder','plum','linen','slate') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','cyan','green','sienna','brown','lawn') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','bisque','khaki','yellow','white','tan') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','black','gainsboro','azure','thistle','aquamarine') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','wheat','royal','thistle','lawn','midnight') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','red','olive','spring','plum','blush') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orchid','antique','sienna','lime','orange','pink') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','cornflower','cornsilk','indian','orange','khaki') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','misty','lemon','ghost','yellow','chiffon') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','dodger','navajo','olive','deep','forest') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','misty','honeydew','aquamarine','bisque','maroon') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','blanched','pink','peach','burnished','snow') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','cyan','floral','white','midnight','dodger') and          i_current_price between 73 and 73 + 10 and          i_current_price between 73 + 1 and 73 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','honeydew','gainsboro','yellow','rosy','khaki') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','dodger','royal','sandy','peach','lace') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','dark','pale','cream','medium','magenta') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','slate','lime','deep','maroon','lawn') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','cream','cornflower','coral','papaya','goldenrod') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','navajo','plum','medium','dim','goldenrod') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','maroon','blue','green','thistle','steel') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','aquamarine','misty','goldenrod','olive','blue') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','yellow','bisque','salmon','sky','goldenrod') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','powder','chiffon','rosy','goldenrod','dodger') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('maroon','puff','deep','aquamarine','slate','plum') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','deep','black','chocolate','sienna','spring') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blue','antique','lawn','wheat','dodger','saddle') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','deep','peach','forest','hot','beige') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','royal','green','tomato','metallic','tan') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','red','sandy','spring','midnight','violet') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ivory','goldenrod','yellow','burlywood','light','slate') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','grey','burlywood','aquamarine','honeydew','saddle') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','rosy','beige','mint','sky','grey') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','rose','rosy','beige','antique','cream') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','medium','orchid','blush','olive','linen') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','ivory','orchid','royal','magenta','cream') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','goldenrod','slate','coral','sandy','rose') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','pale','sandy','maroon','purple','royal') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','tomato','wheat','ghost','pale','seashell') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','dark','spring','ghost','thistle','gainsboro') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','navajo','moccasin','drab','lawn','bisque') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('antique','dark','burlywood','sienna','grey','aquamarine') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','sienna','brown','indian','spring','blue') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','deep','violet','green','plum','brown') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','firebrick','peach','deep','saddle','dodger') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','plum','steel','pale','linen','magenta') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','azure','maroon','honeydew','snow','sky') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','honeydew','blanched','puff','cream','sienna') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','blush','rose','antique','drab','cornflower') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','drab','seashell','magenta','white','chartreuse') and          i_current_price between 20 and 20 + 10 and          i_current_price between 20 + 1 and 20 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','light','bisque','blush','maroon','chiffon') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','honeydew','maroon','puff','mint','olive') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','plum','orchid','lime','navajo','blanched') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('black','rose','magenta','sky','gainsboro','peru') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','spring','white','antique','pale','magenta') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dim','antique','snow','papaya','magenta','drab') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','metallic','pink','maroon','blush','slate') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','beige','burlywood','papaya','royal','burnished') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('antique','saddle','sandy','lace','grey','indian') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','pale','pink','blanched','bisque','wheat') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','dim','orange','papaya','azure','linen') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','plum','peru','tomato','lace','coral') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','purple','navy','spring','papaya','aquamarine') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','grey','deep','orchid','yellow','wheat') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','chartreuse','firebrick','azure','lemon','spring') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','forest','olive','mint','metallic','dodger') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','drab','sandy','navy','orange','saddle') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','dodger','navajo','cyan','rosy','lavender') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','orange','yellow','chartreuse','aquamarine','medium') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','dodger','tomato','sandy','chartreuse','sky') and          i_current_price between 48 and 48 + 10 and          i_current_price between 48 + 1 and 48 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','cornflower','medium','ghost','aquamarine','powder') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','hot','cornsilk','burnished','navajo','moccasin') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','chartreuse','steel','chiffon','tomato','azure') and          i_current_price between 55 and 55 + 10 and          i_current_price between 55 + 1 and 55 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','metallic','frosted','magenta','chocolate','blanched') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','black','midnight','blanched','rosy','olive') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','orchid','cream','seashell','lemon','chocolate') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('plum','violet','powder','metallic','magenta','salmon') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','misty','midnight','white','aquamarine','chartreuse') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','medium','coral','dim','navajo','peach') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','grey','black','navy','forest','dark') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','rose','khaki','blush','lavender','maroon') and          i_current_price between 8 and 8 + 10 and          i_current_price between 8 + 1 and 8 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','pink','magenta','cornflower','almond','ivory') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','salmon','almond','maroon','saddle','lavender') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','linen','almond','brown','firebrick','hot') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','brown','blush','cornsilk','wheat','tomato') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','black','mint','dim','smoke','green') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','khaki','spring','cyan','azure','dim') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','sandy','magenta','puff','hot','lace') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','purple','pale','smoke','rosy','salmon') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','olive','blush','chartreuse','peach','khaki') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','saddle','firebrick','indian','linen','gainsboro') and          i_current_price between 24 and 24 + 10 and          i_current_price between 24 + 1 and 24 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','frosted','sky','misty','puff','salmon') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('bisque','pink','blush','mint','seashell','maroon') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','chiffon','medium','sky','hot','tomato') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tan','cornflower','frosted','violet','metallic','brown') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','brown','gainsboro','chocolate','goldenrod','chartreuse') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','mint','slate','firebrick','blush','sienna') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','lawn','aquamarine','magenta','grey','ghost') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('smoke','gainsboro','olive','beige','almond','cornflower') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','ghost','linen','powder','beige','olive') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','purple','plum','mint','light','aquamarine') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','chartreuse','peru','tan','aquamarine','rose') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('moccasin','sky','drab','turquoise','saddle','rosy') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','floral','pink','moccasin','smoke','white') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','cream','tan','lawn','sandy','lace') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','navy','cyan','wheat','azure','peru') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','puff','coral','spring','violet','almond') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','seashell','cyan','goldenrod','turquoise','drab') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','metallic','rose','lime','steel','salmon') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','medium','rosy','red','gainsboro','sienna') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','chocolate','rose','ivory','orchid','azure') and          i_current_price between 30 and 30 + 10 and          i_current_price between 30 + 1 and 30 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','navy','cyan','royal','black','sandy') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','papaya','cornsilk','cyan','lawn','burnished') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','salmon','peach','orchid','almond','medium') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','lace','floral','maroon','plum','medium') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','beige','cream','pink','navy','drab') and          i_current_price between 48 and 48 + 10 and          i_current_price between 48 + 1 and 48 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('aquamarine','puff','sandy','chartreuse','goldenrod','lavender') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','blue','dark','khaki','violet','lawn') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','honeydew','purple','tan','cyan','cornflower') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','cornflower','smoke','firebrick','rose','white') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','ivory','purple','dark','snow','cyan') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','dark','drab','hot','lavender','saddle') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','lemon','burnished','ghost','grey','powder') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','chartreuse','grey','lace','plum','brown') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','papaya','red','lawn','metallic','dark') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','deep','chiffon','peach','sandy','magenta') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','papaya','navajo','dim','forest','saddle') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','ivory','chocolate','dim','sky','bisque') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','salmon','indian','slate','deep','rose') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','sienna','burlywood','bisque','maroon','orchid') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','violet','papaya','orange','burnished','royal') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','slate','light','firebrick','medium','bisque') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','grey','smoke','salmon','ghost','purple') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','lime','sandy','hot','tomato','papaya') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','rosy','almond','drab','purple','lime') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','rose','almond','blush','blue','smoke') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','brown','papaya','ghost','hot','blush') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','antique','peach','ghost','floral','wheat') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','maroon','cyan','sky','cream','tan') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lace','firebrick','deep','sandy','maroon','salmon') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','orchid','medium','cream','steel','midnight') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','lawn','seashell','black','dark','indian') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','maroon','lawn','azure','rose','cornflower') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','moccasin','dodger','almond','tomato','spring') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','burnished','moccasin','puff','linen','tan') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pale','chartreuse','sienna','olive','sky','linen') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','metallic','sandy','tan','chocolate','drab') and          i_current_price between 85 and 85 + 10 and          i_current_price between 85 + 1 and 85 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','white','peach','orange','burnished','sky') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','grey','honeydew','magenta','violet','orange') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','cornflower','lace','plum','drab','lemon') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','rosy','wheat','moccasin','burlywood','puff') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','sandy','wheat','pale','grey','blue') and          i_current_price between 5 and 5 + 10 and          i_current_price between 5 + 1 and 5 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','violet','cream','burnished','steel','spring') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('maroon','beige','lavender','chartreuse','chiffon','ghost') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','goldenrod','steel','papaya','gainsboro','bisque') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','navy','dark','drab','frosted','yellow') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','gainsboro','antique','blush','chartreuse','forest') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','moccasin','purple','cyan','yellow','white') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','lemon','deep','blanched','pink','wheat') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('aquamarine','gainsboro','navajo','khaki','dim','dark') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','white','lavender','cornflower','metallic','lace') and          i_current_price between 39 and 39 + 10 and          i_current_price between 39 + 1 and 39 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','lime','black','sandy','chiffon','thistle') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','lavender','azure','sienna','wheat','lemon') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','cyan','purple','coral','snow','turquoise') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','burnished','thistle','chiffon','blush','hot') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','salmon','rose','lawn','antique','red') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','grey','light','turquoise','floral','mint') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','thistle','misty','linen','indian','slate') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('indian','violet','slate','rosy','antique','orange') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','hot','chartreuse','gainsboro','dark','chocolate') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','gainsboro','steel','chocolate','peach','frosted') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','pale','aquamarine','puff','orchid','saddle') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','blue','aquamarine','saddle','deep','lemon') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','bisque','aquamarine','goldenrod','grey','gainsboro') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','chocolate','spring','powder','sky','beige') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','navajo','almond','rosy','indian','white') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','antique','blush','chartreuse','turquoise','indian') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','light','goldenrod','tan','dim','orange') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','khaki','salmon','pale','red','honeydew') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','navajo','spring','midnight','chartreuse','coral') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','black','indian','orange','firebrick','blush') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','rose','coral','drab','navy','indian') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','orange','olive','papaya','green','lawn') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','black','chiffon','sienna','medium','indian') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','steel','linen','blue','blanched','plum') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','goldenrod','ghost','blanched','frosted','light') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('mint','light','papaya','frosted','smoke','peach') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','dim','blanched','brown','mint','coral') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','goldenrod','green','turquoise','plum','hot') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lace','midnight','peach','goldenrod','aquamarine','sky') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','wheat','dim','lace','beige','sandy') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','chiffon','lavender','almond','papaya','honeydew') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','frosted','plum','brown','lavender','navajo') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','seashell','misty','orchid','peru','papaya') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','forest','purple','burlywood','chartreuse','midnight') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','dim','azure','misty','beige','burlywood') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','plum','pale','orchid','peach','puff') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','dark','royal','sienna','burlywood','dodger') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','papaya','slate','maroon','dodger','bisque') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','brown','burnished','forest','blanched','slate') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','wheat','navy','firebrick','lemon','steel') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','dim','antique','steel','beige','blanched') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','black','steel','rose','midnight','goldenrod') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','steel','aquamarine','midnight','grey','seashell') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','green','indian','dim','khaki','dark') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cyan','burnished','thistle','peru','frosted','burlywood') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','firebrick','mint','chartreuse','dodger','hot') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','goldenrod','azure','lemon','snow','tomato') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('saddle','frosted','brown','gainsboro','slate','dim') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','grey','lawn','pink','hot','dark') and          i_current_price between 74 and 74 + 10 and          i_current_price between 74 + 1 and 74 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('spring','sienna','mint','smoke','dark','indian') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','indian','black','green','blue','wheat') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ivory','white','drab','seashell','navajo','moccasin') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','linen','drab','lawn','khaki','lace') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','floral','misty','spring','green','goldenrod') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','black','slate','violet','lavender','light') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('aquamarine','mint','misty','beige','plum','cyan') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','purple','light','cream','turquoise','linen') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','snow','antique','lawn','thistle','sienna') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','blanched','gainsboro','cream','brown','sandy') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','olive','cream','aquamarine','saddle','hot') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('powder','navy','brown','black','moccasin','cyan') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','grey','rose','brown','peach','blush') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','puff','orange','burlywood','lemon','firebrick') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','lemon','snow','sky','tan','olive') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','spring','blanched','smoke','white','sandy') and          i_current_price between 66 and 66 + 10 and          i_current_price between 66 + 1 and 66 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','indian','papaya','forest','violet','tomato') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','honeydew','chiffon','slate','antique','spring') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','cornsilk','hot','snow','maroon','salmon') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','light','dodger','blue','ivory','honeydew') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','blue','navy','yellow','powder','cyan') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','maroon','metallic','olive','rosy','almond') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','chartreuse','red','papaya','cornsilk','steel') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','tan','wheat','brown','powder','smoke') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('rose','magenta','thistle','cyan','cream','forest') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','tan','frosted','deep','navajo','dodger') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','salmon','sky','tomato','indian','cream') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','gainsboro','almond','beige','cornsilk','pale') and          i_current_price between 62 and 62 + 10 and          i_current_price between 62 + 1 and 62 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blue','medium','firebrick','rosy','blanched','steel') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','sienna','orchid','sky','firebrick','coral') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','hot','blush','lime','sienna','peach') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','white','olive','tomato','orchid','puff') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('midnight','dodger','azure','drab','chiffon','peru') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('brown','drab','light','linen','metallic','grey') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cyan','lace','violet','pale','dim','brown') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','purple','smoke','burlywood','midnight','chiffon') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','smoke','pink','rose','misty','beige') and          i_current_price between 77 and 77 + 10 and          i_current_price between 77 + 1 and 77 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','lavender','beige','powder','blush','pale') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','orange','aquamarine','magenta','burnished','floral') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sandy','lemon','turquoise','chartreuse','thistle','tan') and          i_current_price between 38 and 38 + 10 and          i_current_price between 38 + 1 and 38 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('olive','dim','papaya','bisque','misty','cornflower') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tan','purple','olive','firebrick','metallic','navajo') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('thistle','lemon','firebrick','sky','brown','seashell') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('steel','snow','tan','sky','light','puff') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','burnished','sienna','puff','lemon','forest') and          i_current_price between 73 and 73 + 10 and          i_current_price between 73 + 1 and 73 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','pale','peru','orchid','plum','violet') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('antique','goldenrod','floral','papaya','misty','cyan') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','brown','plum','navajo','blanched','sky') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','salmon','azure','chocolate','burnished','smoke') and          i_current_price between 22 and 22 + 10 and          i_current_price between 22 + 1 and 22 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lace','tan','orchid','peru','turquoise','papaya') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','chiffon','saddle','tan','peru','navajo') and          i_current_price between 10 and 10 + 10 and          i_current_price between 10 + 1 and 10 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','light','azure','cyan','ghost','maroon') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','violet','rose','peach','lawn','burlywood') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','dark','grey','blush','hot','gainsboro') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orchid','green','navy','slate','bisque','white') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','deep','cyan','lavender','navy','cornsilk') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','sandy','turquoise','seashell','grey','blue') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','mint','seashell','wheat','ghost','deep') and          i_current_price between 60 and 60 + 10 and          i_current_price between 60 + 1 and 60 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','burlywood','midnight','dim','floral','aquamarine') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','papaya','metallic','azure','red','smoke') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','drab','blush','navajo','smoke','cornflower') and          i_current_price between 14 and 14 + 10 and          i_current_price between 14 + 1 and 14 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('moccasin','dodger','wheat','ivory','puff','light') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','saddle','linen','cyan','metallic','plum') and          i_current_price between 25 and 25 + 10 and          i_current_price between 25 + 1 and 25 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','chiffon','green','lemon','violet','frosted') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','yellow','magenta','salmon','honeydew','blue') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','honeydew','red','navy','lime','midnight') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','beige','grey','violet','brown','white') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','sienna','honeydew','spring','lemon','navajo') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','burnished','maroon','sienna','ghost','navy') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','turquoise','lawn','azure','firebrick','dim') and          i_current_price between 82 and 82 + 10 and          i_current_price between 82 + 1 and 82 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','beige','pink','violet','sienna','chiffon') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','sandy','deep','red','green','indian') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chartreuse','green','cyan','goldenrod','metallic','dodger') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','peru','magenta','bisque','dark','lavender') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','antique','tan','dodger','burlywood','wheat') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','khaki','pale','dim','olive','snow') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dim','cornflower','wheat','sandy','steel','hot') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lemon','brown','saddle','burnished','smoke','turquoise') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','burlywood','lemon','bisque','royal','khaki') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','smoke','pale','lime','metallic','seashell') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blue','lawn','maroon','magenta','pale','purple') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','yellow','floral','drab','navajo','peach') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','floral','wheat','goldenrod','slate','cyan') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','coral','almond','papaya','honeydew','blush') and          i_current_price between 67 and 67 + 10 and          i_current_price between 67 + 1 and 67 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blush','forest','spring','ghost','mint','aquamarine') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','pale','yellow','rose','tan','purple') and          i_current_price between 83 and 83 + 10 and          i_current_price between 83 + 1 and 83 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornsilk','moccasin','bisque','pink','goldenrod','slate') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','indian','burnished','medium','saddle','rosy') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('linen','drab','antique','sandy','frosted','rose') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','navajo','cream','gainsboro','peach','blanched') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','steel','antique','gainsboro','bisque','firebrick') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blue','lace','burnished','khaki','peru','blush') and          i_current_price between 54 and 54 + 10 and          i_current_price between 54 + 1 and 54 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','dim','saddle','tan','azure','steel') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('honeydew','saddle','steel','lawn','misty','lemon') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','indian','lawn','metallic','pink','brown') and          i_current_price between 64 and 64 + 10 and          i_current_price between 64 + 1 and 64 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','sandy','puff','spring','chartreuse','dodger') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','wheat','grey','mint','rose','chocolate') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('aquamarine','puff','peach','chartreuse','snow','cyan') and          i_current_price between 18 and 18 + 10 and          i_current_price between 18 + 1 and 18 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','chartreuse','lemon','metallic','linen','sky') and          i_current_price between 61 and 61 + 10 and          i_current_price between 61 + 1 and 61 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('floral','honeydew','linen','lime','medium','violet') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('salmon','purple','honeydew','sky','sienna','white') and          i_current_price between 78 and 78 + 10 and          i_current_price between 78 + 1 and 78 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','metallic','saddle','navy','peru','lime') and          i_current_price between 12 and 12 + 10 and          i_current_price between 12 + 1 and 12 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','azure','frosted','drab','honeydew','peach') and          i_current_price between 40 and 40 + 10 and          i_current_price between 40 + 1 and 40 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','deep','lace','puff','orchid','sienna') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','aquamarine','tan','papaya','olive','sienna') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','snow','black','thistle','sienna','tan') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pink','violet','green','cornflower','tan','spring') and          i_current_price between 55 and 55 + 10 and          i_current_price between 55 + 1 and 55 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','seashell','lime','lace','peru','deep') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','violet','rosy','thistle','chiffon','linen') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','smoke','yellow','turquoise','purple','green') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sky','indian','pink','spring','floral','aquamarine') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','smoke','floral','papaya','navy','salmon') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','navy','papaya','maroon','salmon','cream') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','olive','cream','linen','peru','medium') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tomato','khaki','goldenrod','lace','black','cornsilk') and          i_current_price between 43 and 43 + 10 and          i_current_price between 43 + 1 and 43 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','saddle','hot','chiffon','ivory','cyan') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('drab','sandy','dim','steel','deep','tan') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burnished','bisque','plum','orange','dark','mint') and          i_current_price between 27 and 27 + 10 and          i_current_price between 27 + 1 and 27 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('forest','dim','slate','midnight','salmon','orange') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('white','magenta','khaki','burlywood','misty','slate') and          i_current_price between 2 and 2 + 10 and          i_current_price between 2 + 1 and 2 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','dark','beige','seashell','metallic','deep') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','chiffon','red','honeydew','deep','ivory') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','lawn','turquoise','plum','yellow','hot') and          i_current_price between 36 and 36 + 10 and          i_current_price between 36 + 1 and 36 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','lace','pink','magenta','sky','burnished') and          i_current_price between 84 and 84 + 10 and          i_current_price between 84 + 1 and 84 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dodger','orchid','moccasin','spring','cornsilk','lawn') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('puff','blue','powder','royal','light','dark') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('blanched','peru','tan','dark','wheat','firebrick') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','cyan','orchid','pink','lavender','brown') and          i_current_price between 37 and 37 + 10 and          i_current_price between 37 + 1 and 37 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('light','rosy','khaki','lace','dark','turquoise') and          i_current_price between 68 and 68 + 10 and          i_current_price between 68 + 1 and 68 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('burlywood','magenta','midnight','forest','brown','navajo') and          i_current_price between 7 and 7 + 10 and          i_current_price between 7 + 1 and 7 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','goldenrod','medium','snow','yellow','blanched') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('metallic','blue','snow','hot','moccasin','ivory') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','papaya','green','black','salmon','thistle') and          i_current_price between 75 and 75 + 10 and          i_current_price between 75 + 1 and 75 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','slate','orchid','royal','moccasin','black') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('moccasin','slate','misty','drab','hot','firebrick') and          i_current_price between 1 and 1 + 10 and          i_current_price between 1 + 1 and 1 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','magenta','green','lemon','sky','drab') and          i_current_price between 49 and 49 + 10 and          i_current_price between 49 + 1 and 49 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peach','coral','papaya','deep','yellow','misty') and          i_current_price between 26 and 26 + 10 and          i_current_price between 26 + 1 and 26 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','frosted','aquamarine','royal','antique','ghost') and          i_current_price between 59 and 59 + 10 and          i_current_price between 59 + 1 and 59 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','orange','navajo','yellow','peru','azure') and          i_current_price between 19 and 19 + 10 and          i_current_price between 19 + 1 and 19 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','indian','deep','smoke','lavender','lawn') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('khaki','lemon','lime','magenta','metallic','peru') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('aquamarine','midnight','chocolate','goldenrod','orchid','metallic') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','purple','ivory','lace','ghost','grey') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','grey','steel','spring','blue','chiffon') and          i_current_price between 3 and 3 + 10 and          i_current_price between 3 + 1 and 3 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','blanched','magenta','aquamarine','sienna','metallic') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','grey','coral','orange','tomato','cornflower') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','rosy','ivory','chocolate','tan','blanched') and          i_current_price between 81 and 81 + 10 and          i_current_price between 81 + 1 and 81 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','tomato','violet','light','pale','spring') and          i_current_price between 58 and 58 + 10 and          i_current_price between 58 + 1 and 58 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('firebrick','orange','grey','puff','goldenrod','seashell') and          i_current_price between 42 and 42 + 10 and          i_current_price between 42 + 1 and 42 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','midnight','aquamarine','purple','navajo','lace') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navy','indian','saddle','snow','cyan','yellow') and          i_current_price between 15 and 15 + 10 and          i_current_price between 15 + 1 and 15 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('tan','royal','grey','goldenrod','blanched','red') and          i_current_price between 56 and 56 + 10 and          i_current_price between 56 + 1 and 56 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lawn','brown','dodger','blue','tomato','lavender') and          i_current_price between 73 and 73 + 10 and          i_current_price between 73 + 1 and 73 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','green','cornsilk','ivory','almond','seashell') and          i_current_price between 57 and 57 + 10 and          i_current_price between 57 + 1 and 57 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('peru','antique','smoke','burnished','honeydew','burlywood') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('frosted','deep','misty','midnight','sandy','burnished') and          i_current_price between 17 and 17 + 10 and          i_current_price between 17 + 1 and 17 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('slate','spring','green','burnished','yellow','lawn') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('smoke','green','metallic','seashell','deep','ghost') and          i_current_price between 31 and 31 + 10 and          i_current_price between 31 + 1 and 31 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('goldenrod','navy','linen','violet','tan','chiffon') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','black','lavender','burnished','goldenrod','burlywood') and          i_current_price between 41 and 41 + 10 and          i_current_price between 41 + 1 and 41 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','coral','salmon','tan','black','blue') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('coral','medium','olive','cyan','smoke','lime') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cyan','pink','chocolate','misty','sienna','snow') and          i_current_price between 44 and 44 + 10 and          i_current_price between 44 + 1 and 44 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('indian','rose','white','turquoise','navajo','blue') and          i_current_price between 4 and 4 + 10 and          i_current_price between 4 + 1 and 4 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('grey','salmon','beige','black','linen','lawn') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','linen','deep','azure','salmon','cornflower') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('hot','olive','magenta','green','chocolate','goldenrod') and          i_current_price between 8 and 8 + 10 and          i_current_price between 8 + 1 and 8 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','beige','navajo','orchid','cornsilk','khaki') and          i_current_price between 35 and 35 + 10 and          i_current_price between 35 + 1 and 35 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('gainsboro','peach','navajo','hot','blush','black') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('pale','dark','sandy','brown','powder','peru') and          i_current_price between 6 and 6 + 10 and          i_current_price between 6 + 1 and 6 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('red','blue','tomato','lime','yellow','magenta') and          i_current_price between 65 and 65 + 10 and          i_current_price between 65 + 1 and 65 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('misty','steel','indian','almond','pink','grey') and          i_current_price between 0 and 0 + 10 and          i_current_price between 0 + 1 and 0 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('papaya','seashell','wheat','almond','linen','puff') and          i_current_price between 46 and 46 + 10 and          i_current_price between 46 + 1 and 46 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('turquoise','lavender','cream','antique','moccasin','misty') and          i_current_price between 29 and 29 + 10 and          i_current_price between 29 + 1 and 29 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cream','orchid','indian','navy','plum','frosted') and          i_current_price between 45 and 45 + 10 and          i_current_price between 45 + 1 and 45 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('snow','smoke','orange','lemon','navy','antique') and          i_current_price between 53 and 53 + 10 and          i_current_price between 53 + 1 and 53 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','drab','yellow','chartreuse','forest','smoke') and          i_current_price between 34 and 34 + 10 and          i_current_price between 34 + 1 and 34 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','coral','moccasin','lime','lavender','plum') and          i_current_price between 50 and 50 + 10 and          i_current_price between 50 + 1 and 50 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('deep','sky','chiffon','dim','blush','blue') and          i_current_price between 28 and 28 + 10 and          i_current_price between 28 + 1 and 28 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lime','wheat','violet','peach','peru','magenta') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('sienna','pale','medium','light','tan','navajo') and          i_current_price between 23 and 23 + 10 and          i_current_price between 23 + 1 and 23 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('royal','snow','thistle','honeydew','black','bisque') and          i_current_price between 9 and 9 + 10 and          i_current_price between 9 + 1 and 9 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('yellow','steel','thistle','purple','dim','drab') and          i_current_price between 69 and 69 + 10 and          i_current_price between 69 + 1 and 69 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('violet','pale','magenta','khaki','seashell','yellow') and          i_current_price between 79 and 79 + 10 and          i_current_price between 79 + 1 and 79 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('magenta','navajo','seashell','sky','thistle','red') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('medium','white','puff','dim','navy','orange') and          i_current_price between 11 and 11 + 10 and          i_current_price between 11 + 1 and 11 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dark','cornflower','bisque','aquamarine','indian','floral') and          i_current_price between 80 and 80 + 10 and          i_current_price between 80 + 1 and 80 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('orange','thistle','dark','drab','gainsboro','light') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('cornflower','medium','spring','peach','dark','green') and          i_current_price between 21 and 21 + 10 and          i_current_price between 21 + 1 and 21 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('seashell','dim','violet','medium','firebrick','ivory') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','linen','royal','plum','peru','brown') and          i_current_price between 71 and 71 + 10 and          i_current_price between 71 + 1 and 71 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('azure','slate','saddle','papaya','rosy','forest') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('beige','peru','lace','moccasin','snow','magenta') and          i_current_price between 33 and 33 + 10 and          i_current_price between 33 + 1 and 33 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('ghost','drab','steel','pale','almond','antique') and          i_current_price between 63 and 63 + 10 and          i_current_price between 63 + 1 and 63 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('almond','lime','thistle','snow','black','tan') and          i_current_price between 51 and 51 + 10 and          i_current_price between 51 + 1 and 51 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('purple','lemon','hot','white','burnished','khaki') and          i_current_price between 52 and 52 + 10 and          i_current_price between 52 + 1 and 52 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('green','seashell','blush','burnished','pale','violet') and          i_current_price between 72 and 72 + 10 and          i_current_price between 72 + 1 and 72 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('navajo','red','plum','rosy','turquoise','cornsilk') and          i_current_price between 70 and 70 + 10 and          i_current_price between 70 + 1 and 70 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('dim','orange','bisque','navajo','slate','lavender') and          i_current_price between 16 and 16 + 10 and          i_current_price between 16 + 1 and 16 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2001 and      cs2.syear = 2001 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('lavender','thistle','indian','olive','papaya','antique') and          i_current_price between 32 and 32 + 10 and          i_current_price between 32 + 1 and 32 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('chocolate','blue','azure','burnished','purple','navajo') and          i_current_price between 47 and 47 + 10 and          i_current_price between 47 + 1 and 47 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 2000 and      cs2.syear = 2000 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number   group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_color in ('wheat','forest','cornsilk','lawn','beige','azure') and          i_current_price between 76 and 76 + 10 and          i_current_price between 76 + 1 and 76 + 15 group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1;  
