select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-28' as date) - interval '30 days')                     and (cast ('2001-04-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-16' as date) - interval '30 days')                     and (cast ('2001-04-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-14' as date) - interval '30 days')                     and (cast ('1998-06-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-16' as date) - interval '30 days')                     and (cast ('1999-02-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-10' as date) - interval '30 days')                     and (cast ('1999-04-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-28' as date) - interval '30 days')                     and (cast ('2002-06-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-06' as date) - interval '30 days')                     and (cast ('2002-03-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-26' as date) - interval '30 days')                     and (cast ('2002-05-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-20' as date) - interval '30 days')                     and (cast ('2001-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-17' as date) - interval '30 days')                     and (cast ('2001-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-24' as date) - interval '30 days')                     and (cast ('1998-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-15' as date) - interval '30 days')                     and (cast ('2000-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-05' as date) - interval '30 days')                     and (cast ('1998-06-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-12' as date) - interval '30 days')                     and (cast ('2002-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-17' as date) - interval '30 days')                     and (cast ('2002-05-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-16' as date) - interval '30 days')                     and (cast ('1998-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-08' as date) - interval '30 days')                     and (cast ('2001-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-27' as date) - interval '30 days')                     and (cast ('2001-04-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-23' as date) - interval '30 days')                     and (cast ('2002-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-23' as date) - interval '30 days')                     and (cast ('2001-06-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-04' as date) - interval '30 days')                     and (cast ('2002-04-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-08' as date) - interval '30 days')                     and (cast ('2002-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-17' as date) - interval '30 days')                     and (cast ('2002-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-08' as date) - interval '30 days')                     and (cast ('2000-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-28' as date) - interval '30 days')                     and (cast ('2000-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-26' as date) - interval '30 days')                     and (cast ('2001-03-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-07' as date) - interval '30 days')                     and (cast ('2001-06-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-27' as date) - interval '30 days')                     and (cast ('2002-03-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-30' as date) - interval '30 days')                     and (cast ('2001-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-05' as date) - interval '30 days')                     and (cast ('2001-06-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-03' as date) - interval '30 days')                     and (cast ('1998-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-22' as date) - interval '30 days')                     and (cast ('2002-02-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-15' as date) - interval '30 days')                     and (cast ('2002-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-04' as date) - interval '30 days')                     and (cast ('1998-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-23' as date) - interval '30 days')                     and (cast ('2000-06-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-13' as date) - interval '30 days')                     and (cast ('1998-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-18' as date) - interval '30 days')                     and (cast ('2002-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-18' as date) - interval '30 days')                     and (cast ('2001-05-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-23' as date) - interval '30 days')                     and (cast ('1999-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-05' as date) - interval '30 days')                     and (cast ('2000-04-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-29' as date) - interval '30 days')                     and (cast ('2000-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-01' as date) - interval '30 days')                     and (cast ('2000-04-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-09' as date) - interval '30 days')                     and (cast ('1999-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-30' as date) - interval '30 days')                     and (cast ('1999-03-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-29' as date) - interval '30 days')                     and (cast ('2001-06-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-29' as date) - interval '30 days')                     and (cast ('1998-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-21' as date) - interval '30 days')                     and (cast ('2000-06-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-19' as date) - interval '30 days')                     and (cast ('2001-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-23' as date) - interval '30 days')                     and (cast ('2002-04-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-15' as date) - interval '30 days')                     and (cast ('2002-05-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-27' as date) - interval '30 days')                     and (cast ('1999-02-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-15' as date) - interval '30 days')                     and (cast ('2002-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-29' as date) - interval '30 days')                     and (cast ('2001-06-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-04' as date) - interval '30 days')                     and (cast ('2000-02-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-06' as date) - interval '30 days')                     and (cast ('2001-02-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-19' as date) - interval '30 days')                     and (cast ('2000-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-24' as date) - interval '30 days')                     and (cast ('1998-05-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-30' as date) - interval '30 days')                     and (cast ('2002-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-22' as date) - interval '30 days')                     and (cast ('1999-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-19' as date) - interval '30 days')                     and (cast ('2001-04-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-02' as date) - interval '30 days')                     and (cast ('1999-02-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-11' as date) - interval '30 days')                     and (cast ('1998-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-27' as date) - interval '30 days')                     and (cast ('1999-05-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-29' as date) - interval '30 days')                     and (cast ('1998-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-18' as date) - interval '30 days')                     and (cast ('1998-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-07' as date) - interval '30 days')                     and (cast ('2002-06-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-23' as date) - interval '30 days')                     and (cast ('2002-03-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-29' as date) - interval '30 days')                     and (cast ('2001-06-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-12' as date) - interval '30 days')                     and (cast ('2001-02-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-19' as date) - interval '30 days')                     and (cast ('2000-04-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-03' as date) - interval '30 days')                     and (cast ('2001-05-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-29' as date) - interval '30 days')                     and (cast ('2000-02-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-29' as date) - interval '30 days')                     and (cast ('2002-06-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-19' as date) - interval '30 days')                     and (cast ('2001-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-04' as date) - interval '30 days')                     and (cast ('1999-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-06' as date) - interval '30 days')                     and (cast ('2002-04-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-21' as date) - interval '30 days')                     and (cast ('1999-02-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-05' as date) - interval '30 days')                     and (cast ('2000-03-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-11' as date) - interval '30 days')                     and (cast ('2001-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-17' as date) - interval '30 days')                     and (cast ('2001-05-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-07' as date) - interval '30 days')                     and (cast ('1998-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-21' as date) - interval '30 days')                     and (cast ('1999-02-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-03' as date) - interval '30 days')                     and (cast ('2000-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-22' as date) - interval '30 days')                     and (cast ('1998-06-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-12' as date) - interval '30 days')                     and (cast ('2002-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-13' as date) - interval '30 days')                     and (cast ('1998-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-21' as date) - interval '30 days')                     and (cast ('2002-04-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-16' as date) - interval '30 days')                     and (cast ('2001-03-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-09' as date) - interval '30 days')                     and (cast ('1998-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-19' as date) - interval '30 days')                     and (cast ('1998-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-14' as date) - interval '30 days')                     and (cast ('1999-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-05' as date) - interval '30 days')                     and (cast ('2000-06-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-21' as date) - interval '30 days')                     and (cast ('1999-06-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-26' as date) - interval '30 days')                     and (cast ('2002-02-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-13' as date) - interval '30 days')                     and (cast ('2000-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-14' as date) - interval '30 days')                     and (cast ('1999-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-15' as date) - interval '30 days')                     and (cast ('1999-03-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-02' as date) - interval '30 days')                     and (cast ('2002-02-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-07' as date) - interval '30 days')                     and (cast ('2002-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-01' as date) - interval '30 days')                     and (cast ('1999-06-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-10' as date) - interval '30 days')                     and (cast ('2001-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-09' as date) - interval '30 days')                     and (cast ('1999-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-29' as date) - interval '30 days')                     and (cast ('1998-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-05' as date) - interval '30 days')                     and (cast ('1999-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-04' as date) - interval '30 days')                     and (cast ('2000-05-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-22' as date) - interval '30 days')                     and (cast ('2001-02-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-15' as date) - interval '30 days')                     and (cast ('2002-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-26' as date) - interval '30 days')                     and (cast ('1999-06-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-30' as date) - interval '30 days')                     and (cast ('2002-05-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-27' as date) - interval '30 days')                     and (cast ('1998-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-15' as date) - interval '30 days')                     and (cast ('1999-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-28' as date) - interval '30 days')                     and (cast ('2002-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-12' as date) - interval '30 days')                     and (cast ('2000-04-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-11' as date) - interval '30 days')                     and (cast ('2002-02-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-21' as date) - interval '30 days')                     and (cast ('1998-04-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-28' as date) - interval '30 days')                     and (cast ('1998-06-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-02' as date) - interval '30 days')                     and (cast ('2000-04-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-07' as date) - interval '30 days')                     and (cast ('2002-06-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-23' as date) - interval '30 days')                     and (cast ('1998-03-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-30' as date) - interval '30 days')                     and (cast ('2000-05-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-16' as date) - interval '30 days')                     and (cast ('2001-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-06' as date) - interval '30 days')                     and (cast ('2000-02-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-07' as date) - interval '30 days')                     and (cast ('2001-02-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-19' as date) - interval '30 days')                     and (cast ('1999-06-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-16' as date) - interval '30 days')                     and (cast ('2002-04-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-26' as date) - interval '30 days')                     and (cast ('2002-04-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-31' as date) - interval '30 days')                     and (cast ('1998-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-05' as date) - interval '30 days')                     and (cast ('2001-06-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-05' as date) - interval '30 days')                     and (cast ('2001-02-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-24' as date) - interval '30 days')                     and (cast ('2001-02-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-09' as date) - interval '30 days')                     and (cast ('1999-05-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-29' as date) - interval '30 days')                     and (cast ('1999-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-30' as date) - interval '30 days')                     and (cast ('1999-05-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-23' as date) - interval '30 days')                     and (cast ('2002-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-28' as date) - interval '30 days')                     and (cast ('1998-06-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-12' as date) - interval '30 days')                     and (cast ('2001-03-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-11' as date) - interval '30 days')                     and (cast ('1998-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-19' as date) - interval '30 days')                     and (cast ('2002-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-02' as date) - interval '30 days')                     and (cast ('1998-05-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-30' as date) - interval '30 days')                     and (cast ('2001-05-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-10' as date) - interval '30 days')                     and (cast ('1998-02-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-18' as date) - interval '30 days')                     and (cast ('2002-06-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-15' as date) - interval '30 days')                     and (cast ('1998-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-07' as date) - interval '30 days')                     and (cast ('1998-03-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-13' as date) - interval '30 days')                     and (cast ('2000-03-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-15' as date) - interval '30 days')                     and (cast ('1998-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-29' as date) - interval '30 days')                     and (cast ('1999-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-13' as date) - interval '30 days')                     and (cast ('1999-06-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-21' as date) - interval '30 days')                     and (cast ('1999-05-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-17' as date) - interval '30 days')                     and (cast ('1999-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-08' as date) - interval '30 days')                     and (cast ('2000-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-23' as date) - interval '30 days')                     and (cast ('2000-05-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-18' as date) - interval '30 days')                     and (cast ('2000-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-19' as date) - interval '30 days')                     and (cast ('2001-03-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-02' as date) - interval '30 days')                     and (cast ('2002-05-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-19' as date) - interval '30 days')                     and (cast ('2000-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-18' as date) - interval '30 days')                     and (cast ('1998-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-08' as date) - interval '30 days')                     and (cast ('2001-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-22' as date) - interval '30 days')                     and (cast ('2000-02-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-04' as date) - interval '30 days')                     and (cast ('2000-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-03' as date) - interval '30 days')                     and (cast ('2001-05-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-28' as date) - interval '30 days')                     and (cast ('2002-05-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-11' as date) - interval '30 days')                     and (cast ('1999-04-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-22' as date) - interval '30 days')                     and (cast ('2002-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-28' as date) - interval '30 days')                     and (cast ('2001-06-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-12' as date) - interval '30 days')                     and (cast ('2000-04-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-16' as date) - interval '30 days')                     and (cast ('1998-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-25' as date) - interval '30 days')                     and (cast ('2000-03-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-10' as date) - interval '30 days')                     and (cast ('1998-05-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-06' as date) - interval '30 days')                     and (cast ('2000-06-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-17' as date) - interval '30 days')                     and (cast ('2001-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-31' as date) - interval '30 days')                     and (cast ('1998-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-30' as date) - interval '30 days')                     and (cast ('2001-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-29' as date) - interval '30 days')                     and (cast ('1999-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-05' as date) - interval '30 days')                     and (cast ('1998-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-12' as date) - interval '30 days')                     and (cast ('2002-02-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-27' as date) - interval '30 days')                     and (cast ('1998-03-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-20' as date) - interval '30 days')                     and (cast ('1998-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-23' as date) - interval '30 days')                     and (cast ('2001-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-21' as date) - interval '30 days')                     and (cast ('2000-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-15' as date) - interval '30 days')                     and (cast ('2001-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-16' as date) - interval '30 days')                     and (cast ('2000-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-03' as date) - interval '30 days')                     and (cast ('2002-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-17' as date) - interval '30 days')                     and (cast ('2000-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-20' as date) - interval '30 days')                     and (cast ('1999-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-05' as date) - interval '30 days')                     and (cast ('2001-02-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-20' as date) - interval '30 days')                     and (cast ('1999-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-06' as date) - interval '30 days')                     and (cast ('2000-02-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-30' as date) - interval '30 days')                     and (cast ('2001-04-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-20' as date) - interval '30 days')                     and (cast ('2000-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-08' as date) - interval '30 days')                     and (cast ('2000-03-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-10' as date) - interval '30 days')                     and (cast ('2002-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-09' as date) - interval '30 days')                     and (cast ('2000-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-28' as date) - interval '30 days')                     and (cast ('1999-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-14' as date) - interval '30 days')                     and (cast ('2002-02-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-16' as date) - interval '30 days')                     and (cast ('2002-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-26' as date) - interval '30 days')                     and (cast ('2002-02-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-01' as date) - interval '30 days')                     and (cast ('1998-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-04' as date) - interval '30 days')                     and (cast ('1998-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-20' as date) - interval '30 days')                     and (cast ('2002-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-28' as date) - interval '30 days')                     and (cast ('2002-04-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-11' as date) - interval '30 days')                     and (cast ('2001-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-10' as date) - interval '30 days')                     and (cast ('1998-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-22' as date) - interval '30 days')                     and (cast ('2001-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-10' as date) - interval '30 days')                     and (cast ('2000-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-11' as date) - interval '30 days')                     and (cast ('2002-03-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-05' as date) - interval '30 days')                     and (cast ('2002-03-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-05' as date) - interval '30 days')                     and (cast ('1999-06-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-28' as date) - interval '30 days')                     and (cast ('1998-06-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-08' as date) - interval '30 days')                     and (cast ('1999-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-17' as date) - interval '30 days')                     and (cast ('2002-05-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-02' as date) - interval '30 days')                     and (cast ('2000-03-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-11' as date) - interval '30 days')                     and (cast ('2001-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-27' as date) - interval '30 days')                     and (cast ('1998-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-06' as date) - interval '30 days')                     and (cast ('2000-04-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-09' as date) - interval '30 days')                     and (cast ('2000-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-03' as date) - interval '30 days')                     and (cast ('2001-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-09' as date) - interval '30 days')                     and (cast ('1998-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-28' as date) - interval '30 days')                     and (cast ('2001-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-09' as date) - interval '30 days')                     and (cast ('2002-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-17' as date) - interval '30 days')                     and (cast ('1998-03-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-15' as date) - interval '30 days')                     and (cast ('1998-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-11' as date) - interval '30 days')                     and (cast ('2002-02-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-21' as date) - interval '30 days')                     and (cast ('2001-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-21' as date) - interval '30 days')                     and (cast ('1999-02-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-27' as date) - interval '30 days')                     and (cast ('2002-02-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-01' as date) - interval '30 days')                     and (cast ('1998-03-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-10' as date) - interval '30 days')                     and (cast ('2002-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-21' as date) - interval '30 days')                     and (cast ('2000-05-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-26' as date) - interval '30 days')                     and (cast ('1999-02-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-07' as date) - interval '30 days')                     and (cast ('2001-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-18' as date) - interval '30 days')                     and (cast ('1999-05-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-21' as date) - interval '30 days')                     and (cast ('2001-02-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-06' as date) - interval '30 days')                     and (cast ('1999-02-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-24' as date) - interval '30 days')                     and (cast ('1999-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-28' as date) - interval '30 days')                     and (cast ('2000-04-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-07' as date) - interval '30 days')                     and (cast ('2000-03-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-06' as date) - interval '30 days')                     and (cast ('2002-05-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-25' as date) - interval '30 days')                     and (cast ('2001-04-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-20' as date) - interval '30 days')                     and (cast ('2000-05-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-09' as date) - interval '30 days')                     and (cast ('2000-05-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-04' as date) - interval '30 days')                     and (cast ('1999-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-01' as date) - interval '30 days')                     and (cast ('1999-04-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-13' as date) - interval '30 days')                     and (cast ('2000-05-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-08' as date) - interval '30 days')                     and (cast ('2001-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-27' as date) - interval '30 days')                     and (cast ('2002-05-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-15' as date) - interval '30 days')                     and (cast ('2002-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-16' as date) - interval '30 days')                     and (cast ('2000-02-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-21' as date) - interval '30 days')                     and (cast ('2002-02-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-28' as date) - interval '30 days')                     and (cast ('1999-06-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-23' as date) - interval '30 days')                     and (cast ('1998-03-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-15' as date) - interval '30 days')                     and (cast ('1998-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-08' as date) - interval '30 days')                     and (cast ('2002-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-17' as date) - interval '30 days')                     and (cast ('2000-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-14' as date) - interval '30 days')                     and (cast ('1999-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-05' as date) - interval '30 days')                     and (cast ('2000-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-07' as date) - interval '30 days')                     and (cast ('2001-03-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-25' as date) - interval '30 days')                     and (cast ('1999-02-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-22' as date) - interval '30 days')                     and (cast ('1999-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-21' as date) - interval '30 days')                     and (cast ('2000-04-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-03' as date) - interval '30 days')                     and (cast ('2001-05-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-09' as date) - interval '30 days')                     and (cast ('1999-06-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-08' as date) - interval '30 days')                     and (cast ('2001-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-07' as date) - interval '30 days')                     and (cast ('2002-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-01' as date) - interval '30 days')                     and (cast ('1998-03-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-17' as date) - interval '30 days')                     and (cast ('1999-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-02' as date) - interval '30 days')                     and (cast ('2001-05-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-13' as date) - interval '30 days')                     and (cast ('1999-03-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-08' as date) - interval '30 days')                     and (cast ('2002-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-01' as date) - interval '30 days')                     and (cast ('2001-03-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-20' as date) - interval '30 days')                     and (cast ('2001-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-30' as date) - interval '30 days')                     and (cast ('2001-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-18' as date) - interval '30 days')                     and (cast ('1998-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-28' as date) - interval '30 days')                     and (cast ('2001-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-01' as date) - interval '30 days')                     and (cast ('2000-06-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-30' as date) - interval '30 days')                     and (cast ('2001-05-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-13' as date) - interval '30 days')                     and (cast ('1999-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-11' as date) - interval '30 days')                     and (cast ('2002-02-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-19' as date) - interval '30 days')                     and (cast ('1999-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-02' as date) - interval '30 days')                     and (cast ('2001-02-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-09' as date) - interval '30 days')                     and (cast ('2001-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-26' as date) - interval '30 days')                     and (cast ('2001-06-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-09' as date) - interval '30 days')                     and (cast ('2000-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-26' as date) - interval '30 days')                     and (cast ('2002-05-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-04' as date) - interval '30 days')                     and (cast ('2002-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-14' as date) - interval '30 days')                     and (cast ('2000-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-31' as date) - interval '30 days')                     and (cast ('1999-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-16' as date) - interval '30 days')                     and (cast ('2002-02-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-10' as date) - interval '30 days')                     and (cast ('2001-02-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-02' as date) - interval '30 days')                     and (cast ('2001-06-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-30' as date) - interval '30 days')                     and (cast ('2000-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-24' as date) - interval '30 days')                     and (cast ('1998-02-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-05' as date) - interval '30 days')                     and (cast ('2000-02-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-17' as date) - interval '30 days')                     and (cast ('2000-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-21' as date) - interval '30 days')                     and (cast ('1999-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-15' as date) - interval '30 days')                     and (cast ('2000-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-23' as date) - interval '30 days')                     and (cast ('2002-05-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-04' as date) - interval '30 days')                     and (cast ('1999-04-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-16' as date) - interval '30 days')                     and (cast ('2002-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-21' as date) - interval '30 days')                     and (cast ('2001-06-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-31' as date) - interval '30 days')                     and (cast ('2000-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-19' as date) - interval '30 days')                     and (cast ('1998-03-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-29' as date) - interval '30 days')                     and (cast ('2001-06-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-13' as date) - interval '30 days')                     and (cast ('2001-03-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-23' as date) - interval '30 days')                     and (cast ('2000-03-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-02' as date) - interval '30 days')                     and (cast ('2000-03-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-23' as date) - interval '30 days')                     and (cast ('2000-06-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-26' as date) - interval '30 days')                     and (cast ('1998-02-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-14' as date) - interval '30 days')                     and (cast ('2000-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-23' as date) - interval '30 days')                     and (cast ('2001-05-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-01' as date) - interval '30 days')                     and (cast ('2000-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-23' as date) - interval '30 days')                     and (cast ('2000-04-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-16' as date) - interval '30 days')                     and (cast ('2002-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-13' as date) - interval '30 days')                     and (cast ('2001-05-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-25' as date) - interval '30 days')                     and (cast ('2000-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-12' as date) - interval '30 days')                     and (cast ('1998-05-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-20' as date) - interval '30 days')                     and (cast ('2000-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-26' as date) - interval '30 days')                     and (cast ('2002-03-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-02' as date) - interval '30 days')                     and (cast ('2001-06-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-14' as date) - interval '30 days')                     and (cast ('2000-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-10' as date) - interval '30 days')                     and (cast ('2000-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-19' as date) - interval '30 days')                     and (cast ('2001-03-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-27' as date) - interval '30 days')                     and (cast ('1999-03-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-09' as date) - interval '30 days')                     and (cast ('2002-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-18' as date) - interval '30 days')                     and (cast ('1998-03-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-09' as date) - interval '30 days')                     and (cast ('2000-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-15' as date) - interval '30 days')                     and (cast ('2000-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-05' as date) - interval '30 days')                     and (cast ('2001-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-19' as date) - interval '30 days')                     and (cast ('2002-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-11' as date) - interval '30 days')                     and (cast ('2000-04-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-15' as date) - interval '30 days')                     and (cast ('2001-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-22' as date) - interval '30 days')                     and (cast ('2001-06-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-27' as date) - interval '30 days')                     and (cast ('2002-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-29' as date) - interval '30 days')                     and (cast ('2001-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-12' as date) - interval '30 days')                     and (cast ('1998-03-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-09' as date) - interval '30 days')                     and (cast ('2001-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-11' as date) - interval '30 days')                     and (cast ('2001-03-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-11' as date) - interval '30 days')                     and (cast ('2001-05-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-04' as date) - interval '30 days')                     and (cast ('2000-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-19' as date) - interval '30 days')                     and (cast ('1998-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-30' as date) - interval '30 days')                     and (cast ('2001-04-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-10' as date) - interval '30 days')                     and (cast ('1998-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-07' as date) - interval '30 days')                     and (cast ('2002-02-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-06' as date) - interval '30 days')                     and (cast ('2000-03-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-16' as date) - interval '30 days')                     and (cast ('2002-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-07' as date) - interval '30 days')                     and (cast ('2001-02-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-14' as date) - interval '30 days')                     and (cast ('2002-05-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-02' as date) - interval '30 days')                     and (cast ('1998-05-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-23' as date) - interval '30 days')                     and (cast ('2000-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-21' as date) - interval '30 days')                     and (cast ('1999-05-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-14' as date) - interval '30 days')                     and (cast ('1998-06-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-05' as date) - interval '30 days')                     and (cast ('2000-04-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-08' as date) - interval '30 days')                     and (cast ('2001-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-02' as date) - interval '30 days')                     and (cast ('1998-02-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-09' as date) - interval '30 days')                     and (cast ('2002-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-01' as date) - interval '30 days')                     and (cast ('2000-06-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-19' as date) - interval '30 days')                     and (cast ('2002-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-01' as date) - interval '30 days')                     and (cast ('1999-05-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-23' as date) - interval '30 days')                     and (cast ('2001-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-06' as date) - interval '30 days')                     and (cast ('1999-04-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-03' as date) - interval '30 days')                     and (cast ('2002-02-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-05' as date) - interval '30 days')                     and (cast ('1998-02-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-14' as date) - interval '30 days')                     and (cast ('1998-02-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-04' as date) - interval '30 days')                     and (cast ('2000-05-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-01' as date) - interval '30 days')                     and (cast ('2000-05-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-05' as date) - interval '30 days')                     and (cast ('1998-04-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-18' as date) - interval '30 days')                     and (cast ('2001-05-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-27' as date) - interval '30 days')                     and (cast ('2001-03-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-02' as date) - interval '30 days')                     and (cast ('2000-03-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-23' as date) - interval '30 days')                     and (cast ('2001-06-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-16' as date) - interval '30 days')                     and (cast ('2000-04-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-21' as date) - interval '30 days')                     and (cast ('2002-04-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-27' as date) - interval '30 days')                     and (cast ('1998-02-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-27' as date) - interval '30 days')                     and (cast ('2002-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-12' as date) - interval '30 days')                     and (cast ('2002-05-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-30' as date) - interval '30 days')                     and (cast ('2001-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-09' as date) - interval '30 days')                     and (cast ('2000-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-19' as date) - interval '30 days')                     and (cast ('2002-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-04' as date) - interval '30 days')                     and (cast ('2001-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-14' as date) - interval '30 days')                     and (cast ('1998-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-10' as date) - interval '30 days')                     and (cast ('2000-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-03' as date) - interval '30 days')                     and (cast ('2001-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-01' as date) - interval '30 days')                     and (cast ('1998-06-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-17' as date) - interval '30 days')                     and (cast ('2002-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-13' as date) - interval '30 days')                     and (cast ('2002-04-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-06' as date) - interval '30 days')                     and (cast ('2002-02-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-24' as date) - interval '30 days')                     and (cast ('1998-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-11' as date) - interval '30 days')                     and (cast ('2001-05-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-08' as date) - interval '30 days')                     and (cast ('1999-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-20' as date) - interval '30 days')                     and (cast ('2002-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-02' as date) - interval '30 days')                     and (cast ('1999-06-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-18' as date) - interval '30 days')                     and (cast ('2000-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-18' as date) - interval '30 days')                     and (cast ('2000-02-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-27' as date) - interval '30 days')                     and (cast ('2001-04-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-29' as date) - interval '30 days')                     and (cast ('1998-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-20' as date) - interval '30 days')                     and (cast ('1999-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-08' as date) - interval '30 days')                     and (cast ('2000-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-03' as date) - interval '30 days')                     and (cast ('1999-02-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-30' as date) - interval '30 days')                     and (cast ('1998-04-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-14' as date) - interval '30 days')                     and (cast ('2002-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-29' as date) - interval '30 days')                     and (cast ('2002-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-24' as date) - interval '30 days')                     and (cast ('2001-02-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-10' as date) - interval '30 days')                     and (cast ('2001-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-18' as date) - interval '30 days')                     and (cast ('2001-05-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-16' as date) - interval '30 days')                     and (cast ('2002-04-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-19' as date) - interval '30 days')                     and (cast ('1998-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-15' as date) - interval '30 days')                     and (cast ('2002-05-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-18' as date) - interval '30 days')                     and (cast ('1999-05-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-10' as date) - interval '30 days')                     and (cast ('2000-02-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-04' as date) - interval '30 days')                     and (cast ('2000-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-28' as date) - interval '30 days')                     and (cast ('2002-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-10' as date) - interval '30 days')                     and (cast ('1998-05-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-22' as date) - interval '30 days')                     and (cast ('1999-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-03' as date) - interval '30 days')                     and (cast ('2001-02-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-09' as date) - interval '30 days')                     and (cast ('1999-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-29' as date) - interval '30 days')                     and (cast ('2000-06-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-25' as date) - interval '30 days')                     and (cast ('2001-02-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-01' as date) - interval '30 days')                     and (cast ('1999-05-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-14' as date) - interval '30 days')                     and (cast ('1999-02-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-13' as date) - interval '30 days')                     and (cast ('2002-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-05' as date) - interval '30 days')                     and (cast ('2001-06-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-24' as date) - interval '30 days')                     and (cast ('2001-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-24' as date) - interval '30 days')                     and (cast ('1999-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-12' as date) - interval '30 days')                     and (cast ('2000-03-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-23' as date) - interval '30 days')                     and (cast ('2000-06-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-09' as date) - interval '30 days')                     and (cast ('2000-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-10' as date) - interval '30 days')                     and (cast ('1998-04-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-06' as date) - interval '30 days')                     and (cast ('2002-03-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-12' as date) - interval '30 days')                     and (cast ('2001-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-01' as date) - interval '30 days')                     and (cast ('2001-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-15' as date) - interval '30 days')                     and (cast ('1998-05-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-15' as date) - interval '30 days')                     and (cast ('1999-03-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-15' as date) - interval '30 days')                     and (cast ('2001-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-26' as date) - interval '30 days')                     and (cast ('2002-04-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-14' as date) - interval '30 days')                     and (cast ('1999-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-08' as date) - interval '30 days')                     and (cast ('1998-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-09' as date) - interval '30 days')                     and (cast ('2001-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-11' as date) - interval '30 days')                     and (cast ('2000-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-13' as date) - interval '30 days')                     and (cast ('1999-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-09' as date) - interval '30 days')                     and (cast ('1999-06-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-16' as date) - interval '30 days')                     and (cast ('1998-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-22' as date) - interval '30 days')                     and (cast ('2000-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-09' as date) - interval '30 days')                     and (cast ('2002-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-22' as date) - interval '30 days')                     and (cast ('2001-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-28' as date) - interval '30 days')                     and (cast ('2000-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-04' as date) - interval '30 days')                     and (cast ('1999-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-17' as date) - interval '30 days')                     and (cast ('2002-05-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-15' as date) - interval '30 days')                     and (cast ('2000-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-01' as date) - interval '30 days')                     and (cast ('2001-04-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-16' as date) - interval '30 days')                     and (cast ('1999-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-24' as date) - interval '30 days')                     and (cast ('2002-06-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-15' as date) - interval '30 days')                     and (cast ('2001-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-01' as date) - interval '30 days')                     and (cast ('2002-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-15' as date) - interval '30 days')                     and (cast ('2001-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-18' as date) - interval '30 days')                     and (cast ('2001-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-18' as date) - interval '30 days')                     and (cast ('1998-02-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-13' as date) - interval '30 days')                     and (cast ('1999-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-11' as date) - interval '30 days')                     and (cast ('2001-03-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-10' as date) - interval '30 days')                     and (cast ('1999-05-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-13' as date) - interval '30 days')                     and (cast ('2002-04-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-24' as date) - interval '30 days')                     and (cast ('1998-02-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-14' as date) - interval '30 days')                     and (cast ('2000-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-03' as date) - interval '30 days')                     and (cast ('2002-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-28' as date) - interval '30 days')                     and (cast ('2002-05-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-07' as date) - interval '30 days')                     and (cast ('1999-02-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-02' as date) - interval '30 days')                     and (cast ('2002-04-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-11' as date) - interval '30 days')                     and (cast ('1998-02-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-15' as date) - interval '30 days')                     and (cast ('1998-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-29' as date) - interval '30 days')                     and (cast ('1999-06-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-22' as date) - interval '30 days')                     and (cast ('2000-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-19' as date) - interval '30 days')                     and (cast ('1998-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-20' as date) - interval '30 days')                     and (cast ('2000-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-22' as date) - interval '30 days')                     and (cast ('2001-06-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-27' as date) - interval '30 days')                     and (cast ('1998-03-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-13' as date) - interval '30 days')                     and (cast ('2000-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-14' as date) - interval '30 days')                     and (cast ('2000-06-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-25' as date) - interval '30 days')                     and (cast ('1998-05-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-25' as date) - interval '30 days')                     and (cast ('2002-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-24' as date) - interval '30 days')                     and (cast ('2000-04-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-11' as date) - interval '30 days')                     and (cast ('2002-02-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-15' as date) - interval '30 days')                     and (cast ('2001-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-25' as date) - interval '30 days')                     and (cast ('2002-03-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-11' as date) - interval '30 days')                     and (cast ('2002-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-28' as date) - interval '30 days')                     and (cast ('1998-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-19' as date) - interval '30 days')                     and (cast ('1999-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-17' as date) - interval '30 days')                     and (cast ('2002-03-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-06' as date) - interval '30 days')                     and (cast ('2001-04-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-03' as date) - interval '30 days')                     and (cast ('2000-05-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-13' as date) - interval '30 days')                     and (cast ('1999-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-09' as date) - interval '30 days')                     and (cast ('1999-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-04' as date) - interval '30 days')                     and (cast ('1998-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-05' as date) - interval '30 days')                     and (cast ('1998-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-04' as date) - interval '30 days')                     and (cast ('1999-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-08' as date) - interval '30 days')                     and (cast ('2002-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-02' as date) - interval '30 days')                     and (cast ('2001-04-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-20' as date) - interval '30 days')                     and (cast ('2002-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-28' as date) - interval '30 days')                     and (cast ('1998-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-02' as date) - interval '30 days')                     and (cast ('1999-05-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-12' as date) - interval '30 days')                     and (cast ('2001-02-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-26' as date) - interval '30 days')                     and (cast ('2001-05-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-11' as date) - interval '30 days')                     and (cast ('1999-03-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-25' as date) - interval '30 days')                     and (cast ('2001-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-14' as date) - interval '30 days')                     and (cast ('1998-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-25' as date) - interval '30 days')                     and (cast ('2002-03-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-02' as date) - interval '30 days')                     and (cast ('2002-04-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-30' as date) - interval '30 days')                     and (cast ('1998-03-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-11' as date) - interval '30 days')                     and (cast ('2000-04-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-14' as date) - interval '30 days')                     and (cast ('2000-06-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-28' as date) - interval '30 days')                     and (cast ('1999-04-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-03' as date) - interval '30 days')                     and (cast ('1998-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-09' as date) - interval '30 days')                     and (cast ('2002-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-24' as date) - interval '30 days')                     and (cast ('2002-06-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-09' as date) - interval '30 days')                     and (cast ('2002-06-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-25' as date) - interval '30 days')                     and (cast ('1999-05-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-11' as date) - interval '30 days')                     and (cast ('2002-05-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-10' as date) - interval '30 days')                     and (cast ('1998-04-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-19' as date) - interval '30 days')                     and (cast ('1998-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-08' as date) - interval '30 days')                     and (cast ('1999-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-21' as date) - interval '30 days')                     and (cast ('2002-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-14' as date) - interval '30 days')                     and (cast ('1999-05-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-17' as date) - interval '30 days')                     and (cast ('1999-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-16' as date) - interval '30 days')                     and (cast ('2001-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-05' as date) - interval '30 days')                     and (cast ('2001-02-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-19' as date) - interval '30 days')                     and (cast ('1999-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-31' as date) - interval '30 days')                     and (cast ('1999-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-20' as date) - interval '30 days')                     and (cast ('2001-04-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-07' as date) - interval '30 days')                     and (cast ('1998-04-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-29' as date) - interval '30 days')                     and (cast ('2000-02-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-11' as date) - interval '30 days')                     and (cast ('1998-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-05' as date) - interval '30 days')                     and (cast ('2002-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-24' as date) - interval '30 days')                     and (cast ('1998-02-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-18' as date) - interval '30 days')                     and (cast ('2000-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-07' as date) - interval '30 days')                     and (cast ('1998-03-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-07' as date) - interval '30 days')                     and (cast ('2000-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-21' as date) - interval '30 days')                     and (cast ('1998-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-22' as date) - interval '30 days')                     and (cast ('1999-05-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-08' as date) - interval '30 days')                     and (cast ('2002-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-20' as date) - interval '30 days')                     and (cast ('2001-05-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-17' as date) - interval '30 days')                     and (cast ('1999-03-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-10' as date) - interval '30 days')                     and (cast ('2000-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-25' as date) - interval '30 days')                     and (cast ('1999-02-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-12' as date) - interval '30 days')                     and (cast ('2002-02-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-02' as date) - interval '30 days')                     and (cast ('1999-04-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-12' as date) - interval '30 days')                     and (cast ('1998-03-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-15' as date) - interval '30 days')                     and (cast ('2001-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-27' as date) - interval '30 days')                     and (cast ('1999-02-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-08' as date) - interval '30 days')                     and (cast ('1998-02-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-17' as date) - interval '30 days')                     and (cast ('2002-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-19' as date) - interval '30 days')                     and (cast ('1999-03-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-16' as date) - interval '30 days')                     and (cast ('2000-03-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-27' as date) - interval '30 days')                     and (cast ('1999-04-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-11' as date) - interval '30 days')                     and (cast ('1998-02-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-04' as date) - interval '30 days')                     and (cast ('2000-05-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-02' as date) - interval '30 days')                     and (cast ('2001-06-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-13' as date) - interval '30 days')                     and (cast ('1998-04-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-28' as date) - interval '30 days')                     and (cast ('1998-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-10' as date) - interval '30 days')                     and (cast ('2000-05-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-07' as date) - interval '30 days')                     and (cast ('2002-04-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-04' as date) - interval '30 days')                     and (cast ('1998-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-30' as date) - interval '30 days')                     and (cast ('1998-03-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-08' as date) - interval '30 days')                     and (cast ('2001-02-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-27' as date) - interval '30 days')                     and (cast ('2001-05-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-18' as date) - interval '30 days')                     and (cast ('1999-06-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-17' as date) - interval '30 days')                     and (cast ('1998-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-19' as date) - interval '30 days')                     and (cast ('2002-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-06' as date) - interval '30 days')                     and (cast ('2002-06-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-21' as date) - interval '30 days')                     and (cast ('1999-05-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-17' as date) - interval '30 days')                     and (cast ('2000-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-20' as date) - interval '30 days')                     and (cast ('2000-04-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-26' as date) - interval '30 days')                     and (cast ('2001-03-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-12' as date) - interval '30 days')                     and (cast ('2002-05-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-24' as date) - interval '30 days')                     and (cast ('2002-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-23' as date) - interval '30 days')                     and (cast ('2000-04-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-27' as date) - interval '30 days')                     and (cast ('1998-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-12' as date) - interval '30 days')                     and (cast ('1998-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-14' as date) - interval '30 days')                     and (cast ('2001-06-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-19' as date) - interval '30 days')                     and (cast ('2000-03-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-10' as date) - interval '30 days')                     and (cast ('2000-05-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-01' as date) - interval '30 days')                     and (cast ('2001-06-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-17' as date) - interval '30 days')                     and (cast ('1999-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-03' as date) - interval '30 days')                     and (cast ('2000-05-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-26' as date) - interval '30 days')                     and (cast ('2002-05-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-06' as date) - interval '30 days')                     and (cast ('2001-06-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-23' as date) - interval '30 days')                     and (cast ('1998-05-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-16' as date) - interval '30 days')                     and (cast ('2001-03-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-27' as date) - interval '30 days')                     and (cast ('1998-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-05' as date) - interval '30 days')                     and (cast ('1999-03-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-22' as date) - interval '30 days')                     and (cast ('2000-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-27' as date) - interval '30 days')                     and (cast ('2002-03-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-09' as date) - interval '30 days')                     and (cast ('2002-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-12' as date) - interval '30 days')                     and (cast ('2001-05-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-15' as date) - interval '30 days')                     and (cast ('1999-05-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-05' as date) - interval '30 days')                     and (cast ('2000-02-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-09' as date) - interval '30 days')                     and (cast ('2000-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-20' as date) - interval '30 days')                     and (cast ('2002-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-15' as date) - interval '30 days')                     and (cast ('2000-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-21' as date) - interval '30 days')                     and (cast ('2000-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-19' as date) - interval '30 days')                     and (cast ('2000-06-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-10' as date) - interval '30 days')                     and (cast ('1999-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-22' as date) - interval '30 days')                     and (cast ('2000-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-10' as date) - interval '30 days')                     and (cast ('1999-04-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-14' as date) - interval '30 days')                     and (cast ('2002-02-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-08' as date) - interval '30 days')                     and (cast ('1998-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-02' as date) - interval '30 days')                     and (cast ('2000-03-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-16' as date) - interval '30 days')                     and (cast ('1998-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-10' as date) - interval '30 days')                     and (cast ('2000-05-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-03' as date) - interval '30 days')                     and (cast ('2000-04-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-20' as date) - interval '30 days')                     and (cast ('2000-05-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-02' as date) - interval '30 days')                     and (cast ('2000-03-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-18' as date) - interval '30 days')                     and (cast ('2000-04-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-30' as date) - interval '30 days')                     and (cast ('2002-03-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-15' as date) - interval '30 days')                     and (cast ('2000-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-04' as date) - interval '30 days')                     and (cast ('1999-05-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-10' as date) - interval '30 days')                     and (cast ('1998-02-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-10' as date) - interval '30 days')                     and (cast ('1998-02-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-11' as date) - interval '30 days')                     and (cast ('1999-05-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-14' as date) - interval '30 days')                     and (cast ('2001-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-19' as date) - interval '30 days')                     and (cast ('2000-03-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-20' as date) - interval '30 days')                     and (cast ('1999-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-24' as date) - interval '30 days')                     and (cast ('1998-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-18' as date) - interval '30 days')                     and (cast ('1998-03-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-29' as date) - interval '30 days')                     and (cast ('2000-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-06' as date) - interval '30 days')                     and (cast ('2001-06-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-16' as date) - interval '30 days')                     and (cast ('1998-04-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-19' as date) - interval '30 days')                     and (cast ('1999-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-28' as date) - interval '30 days')                     and (cast ('1998-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-28' as date) - interval '30 days')                     and (cast ('1999-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-24' as date) - interval '30 days')                     and (cast ('2000-02-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-25' as date) - interval '30 days')                     and (cast ('2000-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-07' as date) - interval '30 days')                     and (cast ('2000-06-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-01' as date) - interval '30 days')                     and (cast ('2001-03-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-26' as date) - interval '30 days')                     and (cast ('2001-04-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-09' as date) - interval '30 days')                     and (cast ('1999-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-01' as date) - interval '30 days')                     and (cast ('1998-04-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-09' as date) - interval '30 days')                     and (cast ('1998-06-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-29' as date) - interval '30 days')                     and (cast ('1998-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-29' as date) - interval '30 days')                     and (cast ('2001-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-10' as date) - interval '30 days')                     and (cast ('1999-04-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-18' as date) - interval '30 days')                     and (cast ('2002-06-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-20' as date) - interval '30 days')                     and (cast ('1998-04-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-30' as date) - interval '30 days')                     and (cast ('2001-05-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-30' as date) - interval '30 days')                     and (cast ('2000-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-13' as date) - interval '30 days')                     and (cast ('2002-05-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-19' as date) - interval '30 days')                     and (cast ('2002-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-09' as date) - interval '30 days')                     and (cast ('2000-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-20' as date) - interval '30 days')                     and (cast ('2001-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-25' as date) - interval '30 days')                     and (cast ('2001-03-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-22' as date) - interval '30 days')                     and (cast ('2002-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-04' as date) - interval '30 days')                     and (cast ('1999-02-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-17' as date) - interval '30 days')                     and (cast ('2000-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-08' as date) - interval '30 days')                     and (cast ('2000-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-23' as date) - interval '30 days')                     and (cast ('2001-04-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-02' as date) - interval '30 days')                     and (cast ('2000-02-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-17' as date) - interval '30 days')                     and (cast ('1998-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-01' as date) - interval '30 days')                     and (cast ('2002-06-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-22' as date) - interval '30 days')                     and (cast ('2001-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-27' as date) - interval '30 days')                     and (cast ('2000-04-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-17' as date) - interval '30 days')                     and (cast ('2000-05-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-31' as date) - interval '30 days')                     and (cast ('1998-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-03' as date) - interval '30 days')                     and (cast ('1999-04-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-16' as date) - interval '30 days')                     and (cast ('2001-02-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-10' as date) - interval '30 days')                     and (cast ('2000-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-09' as date) - interval '30 days')                     and (cast ('1998-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-26' as date) - interval '30 days')                     and (cast ('2001-04-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-11' as date) - interval '30 days')                     and (cast ('2001-05-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-15' as date) - interval '30 days')                     and (cast ('2001-05-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-31' as date) - interval '30 days')                     and (cast ('2001-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-08' as date) - interval '30 days')                     and (cast ('2001-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-01' as date) - interval '30 days')                     and (cast ('1998-03-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-11' as date) - interval '30 days')                     and (cast ('1999-04-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-17' as date) - interval '30 days')                     and (cast ('1999-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-30' as date) - interval '30 days')                     and (cast ('1999-04-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-19' as date) - interval '30 days')                     and (cast ('1999-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-20' as date) - interval '30 days')                     and (cast ('2002-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-06' as date) - interval '30 days')                     and (cast ('2000-04-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-14' as date) - interval '30 days')                     and (cast ('2000-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-09' as date) - interval '30 days')                     and (cast ('2001-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-18' as date) - interval '30 days')                     and (cast ('2000-05-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-13' as date) - interval '30 days')                     and (cast ('2002-06-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-02' as date) - interval '30 days')                     and (cast ('1998-06-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-09' as date) - interval '30 days')                     and (cast ('2001-05-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-11' as date) - interval '30 days')                     and (cast ('1999-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-09' as date) - interval '30 days')                     and (cast ('1999-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-17' as date) - interval '30 days')                     and (cast ('2001-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-28' as date) - interval '30 days')                     and (cast ('1999-04-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-21' as date) - interval '30 days')                     and (cast ('1999-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-02' as date) - interval '30 days')                     and (cast ('2001-04-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-22' as date) - interval '30 days')                     and (cast ('1998-02-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-04' as date) - interval '30 days')                     and (cast ('1998-04-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-04' as date) - interval '30 days')                     and (cast ('2002-05-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-17' as date) - interval '30 days')                     and (cast ('2002-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-17' as date) - interval '30 days')                     and (cast ('2001-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-20' as date) - interval '30 days')                     and (cast ('2001-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-30' as date) - interval '30 days')                     and (cast ('1999-03-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-16' as date) - interval '30 days')                     and (cast ('2000-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-28' as date) - interval '30 days')                     and (cast ('1998-06-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-26' as date) - interval '30 days')                     and (cast ('2001-03-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-05' as date) - interval '30 days')                     and (cast ('1999-04-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-25' as date) - interval '30 days')                     and (cast ('2000-02-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-17' as date) - interval '30 days')                     and (cast ('1999-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-12' as date) - interval '30 days')                     and (cast ('1998-03-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-15' as date) - interval '30 days')                     and (cast ('2000-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-31' as date) - interval '30 days')                     and (cast ('1999-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-03' as date) - interval '30 days')                     and (cast ('2002-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-24' as date) - interval '30 days')                     and (cast ('1998-02-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-05' as date) - interval '30 days')                     and (cast ('2002-04-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-26' as date) - interval '30 days')                     and (cast ('2002-03-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-18' as date) - interval '30 days')                     and (cast ('2001-06-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-28' as date) - interval '30 days')                     and (cast ('1999-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-26' as date) - interval '30 days')                     and (cast ('1999-02-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-08' as date) - interval '30 days')                     and (cast ('1999-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-08' as date) - interval '30 days')                     and (cast ('2000-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-20' as date) - interval '30 days')                     and (cast ('2001-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-17' as date) - interval '30 days')                     and (cast ('1998-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-16' as date) - interval '30 days')                     and (cast ('1999-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-10' as date) - interval '30 days')                     and (cast ('2002-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-01' as date) - interval '30 days')                     and (cast ('2002-03-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-05' as date) - interval '30 days')                     and (cast ('2002-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-08' as date) - interval '30 days')                     and (cast ('1999-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-19' as date) - interval '30 days')                     and (cast ('1998-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-21' as date) - interval '30 days')                     and (cast ('1999-06-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-20' as date) - interval '30 days')                     and (cast ('2000-04-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-23' as date) - interval '30 days')                     and (cast ('1999-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-25' as date) - interval '30 days')                     and (cast ('1999-05-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-25' as date) - interval '30 days')                     and (cast ('2002-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-26' as date) - interval '30 days')                     and (cast ('2001-04-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-26' as date) - interval '30 days')                     and (cast ('2000-05-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-31' as date) - interval '30 days')                     and (cast ('2000-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-08' as date) - interval '30 days')                     and (cast ('1998-03-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-15' as date) - interval '30 days')                     and (cast ('2001-06-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-23' as date) - interval '30 days')                     and (cast ('2001-05-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-27' as date) - interval '30 days')                     and (cast ('1999-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-29' as date) - interval '30 days')                     and (cast ('2000-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-12' as date) - interval '30 days')                     and (cast ('2002-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-03' as date) - interval '30 days')                     and (cast ('1999-02-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-16' as date) - interval '30 days')                     and (cast ('2002-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-08' as date) - interval '30 days')                     and (cast ('2001-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-07' as date) - interval '30 days')                     and (cast ('2001-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-03' as date) - interval '30 days')                     and (cast ('2001-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-26' as date) - interval '30 days')                     and (cast ('1999-06-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-24' as date) - interval '30 days')                     and (cast ('2002-06-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-16' as date) - interval '30 days')                     and (cast ('2002-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-09' as date) - interval '30 days')                     and (cast ('2000-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-06' as date) - interval '30 days')                     and (cast ('1998-06-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-15' as date) - interval '30 days')                     and (cast ('2001-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-24' as date) - interval '30 days')                     and (cast ('1998-06-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-24' as date) - interval '30 days')                     and (cast ('1999-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-19' as date) - interval '30 days')                     and (cast ('2001-06-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-01' as date) - interval '30 days')                     and (cast ('2002-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-08' as date) - interval '30 days')                     and (cast ('2001-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-04' as date) - interval '30 days')                     and (cast ('2001-02-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-04' as date) - interval '30 days')                     and (cast ('1999-05-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-17' as date) - interval '30 days')                     and (cast ('2000-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-19' as date) - interval '30 days')                     and (cast ('2001-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-17' as date) - interval '30 days')                     and (cast ('1998-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-30' as date) - interval '30 days')                     and (cast ('2001-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-20' as date) - interval '30 days')                     and (cast ('1999-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-10' as date) - interval '30 days')                     and (cast ('1998-05-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-31' as date) - interval '30 days')                     and (cast ('1998-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-18' as date) - interval '30 days')                     and (cast ('1998-03-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-27' as date) - interval '30 days')                     and (cast ('2002-05-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-17' as date) - interval '30 days')                     and (cast ('2000-04-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-22' as date) - interval '30 days')                     and (cast ('2002-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-16' as date) - interval '30 days')                     and (cast ('1998-06-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-24' as date) - interval '30 days')                     and (cast ('1999-05-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-09' as date) - interval '30 days')                     and (cast ('2001-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-05' as date) - interval '30 days')                     and (cast ('2002-03-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-14' as date) - interval '30 days')                     and (cast ('2002-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-02' as date) - interval '30 days')                     and (cast ('2000-04-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-25' as date) - interval '30 days')                     and (cast ('1998-02-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-15' as date) - interval '30 days')                     and (cast ('2002-04-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-17' as date) - interval '30 days')                     and (cast ('2001-05-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-07' as date) - interval '30 days')                     and (cast ('1999-04-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-27' as date) - interval '30 days')                     and (cast ('1999-03-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-14' as date) - interval '30 days')                     and (cast ('1998-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-08' as date) - interval '30 days')                     and (cast ('1998-02-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-28' as date) - interval '30 days')                     and (cast ('1999-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-16' as date) - interval '30 days')                     and (cast ('2001-03-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-09' as date) - interval '30 days')                     and (cast ('2002-06-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-10' as date) - interval '30 days')                     and (cast ('1999-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-06' as date) - interval '30 days')                     and (cast ('2001-04-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-20' as date) - interval '30 days')                     and (cast ('1999-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-07' as date) - interval '30 days')                     and (cast ('2000-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-30' as date) - interval '30 days')                     and (cast ('2001-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-03' as date) - interval '30 days')                     and (cast ('1998-04-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-21' as date) - interval '30 days')                     and (cast ('2001-04-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-09' as date) - interval '30 days')                     and (cast ('2001-05-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-03' as date) - interval '30 days')                     and (cast ('2000-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-01' as date) - interval '30 days')                     and (cast ('2001-04-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-06' as date) - interval '30 days')                     and (cast ('1998-06-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-29' as date) - interval '30 days')                     and (cast ('2002-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-20' as date) - interval '30 days')                     and (cast ('2000-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-08' as date) - interval '30 days')                     and (cast ('1999-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-30' as date) - interval '30 days')                     and (cast ('2002-04-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-21' as date) - interval '30 days')                     and (cast ('2002-06-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-16' as date) - interval '30 days')                     and (cast ('1998-02-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-15' as date) - interval '30 days')                     and (cast ('2000-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-12' as date) - interval '30 days')                     and (cast ('1998-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-03' as date) - interval '30 days')                     and (cast ('1998-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-25' as date) - interval '30 days')                     and (cast ('2002-05-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-25' as date) - interval '30 days')                     and (cast ('2000-03-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-28' as date) - interval '30 days')                     and (cast ('2001-05-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-19' as date) - interval '30 days')                     and (cast ('1999-04-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-25' as date) - interval '30 days')                     and (cast ('1998-04-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-23' as date) - interval '30 days')                     and (cast ('2002-05-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-01' as date) - interval '30 days')                     and (cast ('1999-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-20' as date) - interval '30 days')                     and (cast ('2002-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-22' as date) - interval '30 days')                     and (cast ('2000-05-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-27' as date) - interval '30 days')                     and (cast ('1998-04-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-14' as date) - interval '30 days')                     and (cast ('2002-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-28' as date) - interval '30 days')                     and (cast ('2002-04-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-04' as date) - interval '30 days')                     and (cast ('2002-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-07' as date) - interval '30 days')                     and (cast ('2000-04-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-20' as date) - interval '30 days')                     and (cast ('1999-05-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-13' as date) - interval '30 days')                     and (cast ('2000-03-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-20' as date) - interval '30 days')                     and (cast ('2000-04-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-30' as date) - interval '30 days')                     and (cast ('2001-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-13' as date) - interval '30 days')                     and (cast ('1999-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-02' as date) - interval '30 days')                     and (cast ('1998-02-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-20' as date) - interval '30 days')                     and (cast ('1999-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-22' as date) - interval '30 days')                     and (cast ('2001-06-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-22' as date) - interval '30 days')                     and (cast ('1999-05-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-22' as date) - interval '30 days')                     and (cast ('1999-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-06' as date) - interval '30 days')                     and (cast ('2000-02-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-28' as date) - interval '30 days')                     and (cast ('2002-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-09' as date) - interval '30 days')                     and (cast ('1998-05-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-03' as date) - interval '30 days')                     and (cast ('1999-02-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-18' as date) - interval '30 days')                     and (cast ('2000-03-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-04' as date) - interval '30 days')                     and (cast ('2001-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-17' as date) - interval '30 days')                     and (cast ('2000-06-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-13' as date) - interval '30 days')                     and (cast ('2000-06-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-04' as date) - interval '30 days')                     and (cast ('1999-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-09' as date) - interval '30 days')                     and (cast ('1998-02-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-29' as date) - interval '30 days')                     and (cast ('1998-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-14' as date) - interval '30 days')                     and (cast ('2000-05-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-18' as date) - interval '30 days')                     and (cast ('1998-02-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-12' as date) - interval '30 days')                     and (cast ('2002-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-30' as date) - interval '30 days')                     and (cast ('1998-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-03' as date) - interval '30 days')                     and (cast ('2002-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-28' as date) - interval '30 days')                     and (cast ('2000-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-18' as date) - interval '30 days')                     and (cast ('1998-05-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-01' as date) - interval '30 days')                     and (cast ('2002-04-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-06' as date) - interval '30 days')                     and (cast ('1998-06-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-26' as date) - interval '30 days')                     and (cast ('2000-04-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-26' as date) - interval '30 days')                     and (cast ('2000-04-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-30' as date) - interval '30 days')                     and (cast ('1999-06-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-02' as date) - interval '30 days')                     and (cast ('1999-06-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-07' as date) - interval '30 days')                     and (cast ('2001-06-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-25' as date) - interval '30 days')                     and (cast ('2001-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-04' as date) - interval '30 days')                     and (cast ('2002-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-25' as date) - interval '30 days')                     and (cast ('2001-04-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-04' as date) - interval '30 days')                     and (cast ('1999-02-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-09' as date) - interval '30 days')                     and (cast ('1998-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-22' as date) - interval '30 days')                     and (cast ('1998-04-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-12' as date) - interval '30 days')                     and (cast ('2001-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-07' as date) - interval '30 days')                     and (cast ('2001-02-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-12' as date) - interval '30 days')                     and (cast ('2000-05-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-01' as date) - interval '30 days')                     and (cast ('2000-06-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-14' as date) - interval '30 days')                     and (cast ('2000-06-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-30' as date) - interval '30 days')                     and (cast ('1999-03-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-05' as date) - interval '30 days')                     and (cast ('2001-06-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-28' as date) - interval '30 days')                     and (cast ('2000-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-08' as date) - interval '30 days')                     and (cast ('1999-02-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-22' as date) - interval '30 days')                     and (cast ('2000-05-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-20' as date) - interval '30 days')                     and (cast ('2002-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-25' as date) - interval '30 days')                     and (cast ('2002-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-14' as date) - interval '30 days')                     and (cast ('1998-02-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-18' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-18' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-18' as date) - interval '30 days')                     and (cast ('2002-02-18' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-12' as date) - interval '30 days')                     and (cast ('1998-03-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-27' as date) - interval '30 days')                     and (cast ('2002-05-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-27' as date) - interval '30 days')                     and (cast ('1998-04-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-29' as date) - interval '30 days')                     and (cast ('2002-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-12' as date) - interval '30 days')                     and (cast ('1998-06-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-03' as date) - interval '30 days')                     and (cast ('2000-04-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-26' as date) - interval '30 days')                     and (cast ('1999-02-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-25' as date) - interval '30 days')                     and (cast ('1998-03-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-28' as date) - interval '30 days')                     and (cast ('1999-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-29' as date) - interval '30 days')                     and (cast ('2000-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-27' as date) - interval '30 days')                     and (cast ('2002-05-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-07' as date) - interval '30 days')                     and (cast ('1998-06-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-01' as date) - interval '30 days')                     and (cast ('1999-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-17' as date) - interval '30 days')                     and (cast ('2002-03-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-08' as date) - interval '30 days')                     and (cast ('1999-05-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-03' as date) - interval '30 days')                     and (cast ('2000-02-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-04' as date) - interval '30 days')                     and (cast ('1998-06-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-07' as date) - interval '30 days')                     and (cast ('1999-02-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-22' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-22' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-22' as date) - interval '30 days')                     and (cast ('1999-03-22' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-17' as date) - interval '30 days')                     and (cast ('2000-05-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-08' as date) - interval '30 days')                     and (cast ('1999-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-25' as date) - interval '30 days')                     and (cast ('1998-03-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-23' as date) - interval '30 days')                     and (cast ('1999-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-25' as date) - interval '30 days')                     and (cast ('1998-04-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-23' as date) - interval '30 days')                     and (cast ('1999-03-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-24' as date) - interval '30 days')                     and (cast ('2002-06-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-03' as date) - interval '30 days')                     and (cast ('2001-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-17' as date) - interval '30 days')                     and (cast ('1999-03-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-26' as date) - interval '30 days')                     and (cast ('2001-05-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-20' as date) - interval '30 days')                     and (cast ('1998-06-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-14' as date) - interval '30 days')                     and (cast ('2001-02-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-21' as date) - interval '30 days')                     and (cast ('2002-05-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-31' as date) - interval '30 days')                     and (cast ('1998-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-23' as date) - interval '30 days')                     and (cast ('2001-03-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-11' as date) - interval '30 days')                     and (cast ('1998-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-01' as date) - interval '30 days')                     and (cast ('2000-04-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-04-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-04-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-04-14' as date) - interval '30 days')                     and (cast ('1998-04-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-31' as date) - interval '30 days')                     and (cast ('2000-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-24' as date) - interval '30 days')                     and (cast ('2001-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-20' as date) - interval '30 days')                     and (cast ('2001-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-16' as date) - interval '30 days')                     and (cast ('1999-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-06' as date) - interval '30 days')                     and (cast ('1999-05-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-07' as date) - interval '30 days')                     and (cast ('1999-02-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-14' as date) - interval '30 days')                     and (cast ('1998-03-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-03-31' as date) - interval '30 days')                     and (cast ('2001-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-10' as date) - interval '30 days')                     and (cast ('2002-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-25' as date) - interval '30 days')                     and (cast ('2000-05-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-11' as date) - interval '30 days')                     and (cast ('2002-03-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-17' as date) - interval '30 days')                     and (cast ('2002-02-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-04' as date) - interval '30 days')                     and (cast ('2001-02-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-16' as date) - interval '30 days')                     and (cast ('2000-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-21' as date) - interval '30 days')                     and (cast ('2001-06-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-06-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-06-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-06-23' as date) - interval '30 days')                     and (cast ('1999-06-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-25' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-25' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-25' as date) - interval '30 days')                     and (cast ('1998-06-25' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-30' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-30' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-30' as date) - interval '30 days')                     and (cast ('2000-03-30' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-21' as date) - interval '30 days')                     and (cast ('1998-02-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-28' as date) - interval '30 days')                     and (cast ('1998-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-02' as date) - interval '30 days')                     and (cast ('2001-06-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-24' as date) - interval '30 days')                     and (cast ('2001-05-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-14' as date) - interval '30 days')                     and (cast ('1998-06-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-13' as date) - interval '30 days')                     and (cast ('1998-02-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-23' as date) - interval '30 days')                     and (cast ('1999-05-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-31' as date) - interval '30 days')                     and (cast ('1998-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-17' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-17' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-17' as date) - interval '30 days')                     and (cast ('1999-03-17' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-24' as date) - interval '30 days')                     and (cast ('2000-05-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-19' as date) - interval '30 days')                     and (cast ('2000-06-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-28' as date) - interval '30 days')                     and (cast ('2000-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-16' as date) - interval '30 days')                     and (cast ('2000-03-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-09' as date) - interval '30 days')                     and (cast ('1999-03-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-11' as date) - interval '30 days')                     and (cast ('2000-02-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-20' as date) - interval '30 days')                     and (cast ('1998-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-31' as date) - interval '30 days')                     and (cast ('2002-05-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-31' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-31' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-31' as date) - interval '30 days')                     and (cast ('2002-03-31' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-10' as date) - interval '30 days')                     and (cast ('2002-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-23' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-23' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-23' as date) - interval '30 days')                     and (cast ('2001-02-23' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-29' as date) - interval '30 days')                     and (cast ('2000-02-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-16' as date) - interval '30 days')                     and (cast ('2000-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-11' as date) - interval '30 days')                     and (cast ('1998-06-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-21' as date) - interval '30 days')                     and (cast ('1998-05-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-04' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-04' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-04' as date) - interval '30 days')                     and (cast ('2000-03-04' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-29' as date) - interval '30 days')                     and (cast ('1998-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-24' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-24' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-24' as date) - interval '30 days')                     and (cast ('1998-03-24' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-09' as date) - interval '30 days')                     and (cast ('1999-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-28' as date) - interval '30 days')                     and (cast ('2000-02-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-03' as date) - interval '30 days')                     and (cast ('2000-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-05' as date) - interval '30 days')                     and (cast ('2002-03-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-20' as date) - interval '30 days')                     and (cast ('1999-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-19' as date) - interval '30 days')                     and (cast ('1999-04-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-05' as date) - interval '30 days')                     and (cast ('2001-04-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-20' as date) - interval '30 days')                     and (cast ('2000-02-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-21' as date) - interval '30 days')                     and (cast ('2000-02-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-02-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-02-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-02-12' as date) - interval '30 days')                     and (cast ('2002-02-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-20' as date) - interval '30 days')                     and (cast ('2002-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-06' as date) - interval '30 days')                     and (cast ('1998-05-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-05-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-05-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-05-26' as date) - interval '30 days')                     and (cast ('1999-05-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-10' as date) - interval '30 days')                     and (cast ('2000-04-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-29' as date) - interval '30 days')                     and (cast ('2000-05-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-06-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-06-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-06-10' as date) - interval '30 days')                     and (cast ('2000-06-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-08' as date) - interval '30 days')                     and (cast ('2000-03-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-08' as date) - interval '30 days')                     and (cast ('2001-04-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-06-03' as date) - interval '30 days')                     and (cast ('2001-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-03' as date) - interval '30 days')                     and (cast ('2002-03-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-19' as date) - interval '30 days')                     and (cast ('1998-02-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-10' as date) - interval '30 days')                     and (cast ('2000-03-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-11' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-11' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-11' as date) - interval '30 days')                     and (cast ('2001-05-11' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-16' as date) - interval '30 days')                     and (cast ('1998-05-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-04-09' as date) - interval '30 days')                     and (cast ('2002-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-20' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-20' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-20' as date) - interval '30 days')                     and (cast ('1998-03-20' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-05-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-05-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-05-03' as date) - interval '30 days')                     and (cast ('2001-05-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-09' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-09' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-09' as date) - interval '30 days')                     and (cast ('2001-04-09' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-02-12' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-02-12' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-02-12' as date) - interval '30 days')                     and (cast ('1999-02-12' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-05' as date) - interval '30 days')                     and (cast ('2000-03-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-15' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-15' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-15' as date) - interval '30 days')                     and (cast ('2001-02-15' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-26' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-26' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-26' as date) - interval '30 days')                     and (cast ('2000-03-26' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-04-10' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-04-10' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-04-10' as date) - interval '30 days')                     and (cast ('2001-04-10' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2001-02-02' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2001-02-02' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2001-02-02' as date) - interval '30 days')                     and (cast ('2001-02-02' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-02-14' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-02-14' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-02-14' as date) - interval '30 days')                     and (cast ('1998-02-14' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-29' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-29' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-29' as date) - interval '30 days')                     and (cast ('1999-03-29' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-03-28' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-03-28' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-03-28' as date) - interval '30 days')                     and (cast ('2000-03-28' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-06-08' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-06-08' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-06-08' as date) - interval '30 days')                     and (cast ('2002-06-08' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-05-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-05-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-05-05' as date) - interval '30 days')                     and (cast ('2002-05-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-04-05' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-04-05' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-04-05' as date) - interval '30 days')                     and (cast ('2000-04-05' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-16' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-16' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-16' as date) - interval '30 days')                     and (cast ('1998-03-16' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-03-13' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-03-13' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-03-13' as date) - interval '30 days')                     and (cast ('1998-03-13' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2002-03-21' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2002-03-21' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2002-03-21' as date) - interval '30 days')                     and (cast ('2002-03-21' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-03-06' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-03-06' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-03-06' as date) - interval '30 days')                     and (cast ('1999-03-06' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-05-07' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-05-07' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-05-07' as date) - interval '30 days')                     and (cast ('2000-05-07' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-03' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-03' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-03' as date) - interval '30 days')                     and (cast ('1998-06-03' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1999-04-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1999-04-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1999-04-27' as date) - interval '30 days')                     and (cast ('1999-04-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('2000-02-01' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('2000-02-01' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('2000-02-01' as date) - interval '30 days')                     and (cast ('2000-02-01' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-05-19' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-05-19' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-05-19' as date) - interval '30 days')                     and (cast ('1998-05-19' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
select  *  from(select w_warehouse_name             ,i_item_id             ,sum(case when (cast(d_date as date) < cast ('1998-06-27' as date)) 	                then inv_quantity_on_hand                        else 0 end) as inv_before             ,sum(case when (cast(d_date as date) >= cast ('1998-06-27' as date))                       then inv_quantity_on_hand                        else 0 end) as inv_after    from inventory        ,warehouse        ,item        ,date_dim    where i_current_price between 0.99 and 1.49      and i_item_sk          = inv_item_sk      and inv_warehouse_sk   = w_warehouse_sk      and inv_date_sk    = d_date_sk      and d_date between (cast ('1998-06-27' as date) - interval '30 days')                     and (cast ('1998-06-27' as date) + interval '30 days')    group by w_warehouse_name, i_item_id) x  where (case when inv_before > 0               then inv_after / inv_before               else null              end) between 2.0/3.0 and 3.0/2.0  order by w_warehouse_name          ,i_item_id  limit 100;  
